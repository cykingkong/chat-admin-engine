import{v as e,_ as a,u as t}from"./index.a302575e.js";/* empty css                *//* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css              *//* empty css               *//* empty css              *//* empty css              *//* empty css               *//* empty css                *//* empty css                *//* empty css                */import{L as l,C as o,g as n,s}from"./customColumns.632d2feb.js";/* empty css                *//* empty css               *//* empty css               */import{d as i,f as u,aH as r,D as d,aF as c,aJ as p,aK as v,aO as m,H as f,u as y,b_ as g,c2 as h,ch as _,ci as b,c3 as w,bK as k,b9 as x,ba as C,r as I,v as T,o as S,E as N,aM as D,aL as q,aG as Y,aP as O,F as V,bk as j,bA as P,bH as M,by as z,bR as K,bq as U,bQ as A,cj as G,ck as H,bL as B,c8 as F,bu as E,bv as R,c9 as $,cl as J,ce as L,bl as W,bG as Q,bz as X,cm as Z,cn as ee,bM as ae,c5 as te,co as le,bj as oe,be as ne,cf as se,bP as ie,c4 as ue,c6 as re,c7 as de,cp as ce,bN as pe,bn as ve,bU as me,cg as fe,bJ as ye,cd as ge}from"./arco.0e1801a1.js";import{u as he}from"./loading.4d3258a0.js";import{b as _e,c as be,d as we,e as ke,f as xe}from"./plant.a1deaa45.js";import{p as Ce}from"./live.0a587604.js";import{r as Ie,a as Te,i as Se,p as Ne,b as De,c as qe,d as Ye,e as Oe,t as Ve,f as je,g as Pe,h as Me}from"./live-plant.b4469a08.js";import{e as ze,p as Ke,a as Ue,r as Ae,c as Ge,t as He,d as Be}from"./enum.5f967a9b.js";import{s as Fe,a as Ee,b as Re}from"./rule.9a62b1db.js";import{f as $e}from"./vue.6618b53d.js";import{Q as Je}from"./qrcode.vue.esm.973da956.js";import{_ as Le}from"./lodash.64978348.js";import{s as We,c as Qe,b as Xe,d as Ze}from"./sph.fffc74fa.js";import{p as ea,c as aa}from"./address.2140e733.js";import{X as ta,f as la}from"./xlsx.0c218054.js";import{c as oa}from"./event.471a062e.js";import{p as na,a as sa}from"./settings.c4a72107.js";import{u as ia}from"./themes.dd6e2da4.js";import{u as ua}from"./chart-option.ec953526.js";import"./chart.b4fe0742.js";const ra=e=>{let a;if("undefined"!=typeof ArrayBuffer){a=new ArrayBuffer(e.length);const t=new Uint8Array(a);for(let a=0;a!==e.length;++a)t[a]=255&e.charCodeAt(a);return a}a=new Array(e.length);for(let t=0;t!==e.length;++t)a[t]=255&e.charCodeAt(t);return a},da={fixColums:["row-select","plantNameId","op","plantVideo","sphInfo.sphName"],defaultColumns:["estimatedWecoinAmount","process","cost","productOrderCount","productPlaceorderGmv","lr","roi","yl_roi","yjl","airCost","productClickCountUv","exposureCount","targetType","wecoinBid","duration","click_rate","qan_cost","click_cost","zh_cost","cancelPlant","packageInfo.packageName","noCostTime","updatedAt","createdCancelTime","startEndTime","startCostTime","newMemberDepName"]},ca=[{colKey:"row-select",type:"multiple",width:46,fixed:"left",title:"行选择框"},{colKey:"plantNameId",title:"计划名称/Id",width:"200",fixed:"left",align:"left"},{colKey:"op",title:"状态/操作",width:"220",fixed:"left",align:"center"},{colKey:"plantVideo",title:"被投信息",width:"250",align:"left"},{colKey:"sphInfo.sphName",title:"投放号",width:"150",align:"center"},{colKey:"estimatedWecoinAmount",title:"投放金额",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"process",title:"消耗比例",width:"170",align:"center"},{colKey:"cost",title:"消耗金额",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"productOrderCount",title:"订单数",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"productPlaceorderGmv",title:"营业额",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"lr",title:"利润",width:"100",align:"center"},{colKey:"roi",title:"ROI",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"yl_roi",title:"佣金ROI",width:"125",align:"center",sortType:"all",sorter:!0},{colKey:"yjl",title:"佣金率",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"airCost",title:"空耗值",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"productClickCountUv",title:"商品点击",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"exposureCount",title:"浏览",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"targetType",title:"投放目标",width:"100",align:"center"},{colKey:"wecoinBid",title:"出价",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"duration",title:"投放时长",width:"100",align:"center"},{colKey:"click_rate",title:"点击率",width:"100",align:"center"},{colKey:"qan_cost",title:"千展成本",width:"100",align:"center"},{colKey:"click_cost",title:"点击成本",width:"100",align:"center"},{colKey:"zh_cost",title:"转化成本",width:"100",align:"center"},{colKey:"cancelPlant",title:"自动关停",width:"100",align:"center"},{colKey:"packageInfo.packageName",title:"所属计划包",width:"180",align:"center"},{colKey:"noCostTime",title:"无消耗时长",width:"200",align:"center",sorter:!0,sortType:"all"},{colKey:"updatedAt",title:"更新时间",width:"200",align:"center"},{colKey:"createdCancelTime",title:"创建/关闭时间",width:"240"},{colKey:"startEndTime",title:"加热开始/结束时间",width:"240"},{colKey:"startCostTime",title:"开始消耗时间",width:"240",align:"center"},{colKey:"newMemberDepName",title:"所属部门",width:"140",align:"center"}],pa=[{label:"表格行配置",value:"col",children:[{label:"投放数据",value:"liveplacementData",columns:["estimatedWecoinAmount","process","cost","airCost","targetType","wecoinBid","duration","cancelPlant","packageInfo.packageName","updatedAt","yjl","createdCancelTime","noCostTime","startEndTime","startCostTime","newMemberDepName"],check:[]},{label:"加热效果数据",value:"livehd",columns:["productOrderCount","productPlaceorderGmv","lr","roi","yl_roi","productClickCountUv","exposureCount","click_rate","qan_cost","click_cost","zh_cost"],check:[]}]}],va=[{colKey:"row-select",type:"multiple",width:46,fixed:"left",title:"行选择框"},{colKey:"plantNameId",title:"计划名称/Id",width:"200",fixed:"left",align:"left"},{colKey:"op",title:"状态/操作",width:"220",fixed:"left",align:"center"},{colKey:"plantVideo",title:"被投信息",width:"250",align:"left"},{colKey:"sphInfo.sphName",title:"投放号",width:"150",align:"center"},{colKey:"estimatedWecoinAmount",title:"投放金额",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"process",title:"消耗比例",width:"170",align:"center"},{colKey:"cost",title:"消耗金额",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"productOrderCount",title:"订单数",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"productPlaceorderGmv",title:"营业额",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"lr",title:"利润",width:"100",align:"center"},{colKey:"roi",title:"ROI",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"yl_roi",title:"佣金ROI",width:"125",align:"center",sortType:"all",sorter:!0},{colKey:"yjl",title:"佣金率",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"airCost",title:"空耗值",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"productClickCountUv",title:"商品点击",width:"120",align:"center",sortType:"all",sorter:!0},{colKey:"exposureCount",title:"浏览",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"targetType",title:"投放目标",width:"100",align:"center"},{colKey:"wecoinBid",title:"出价",width:"100",align:"center",sortType:"all",sorter:!0},{colKey:"duration",title:"投放时长",width:"100",align:"center"},{colKey:"click_rate",title:"点击率",width:"100",align:"center"},{colKey:"qan_cost",title:"千展成本",width:"100",align:"center"},{colKey:"click_cost",title:"点击成本",width:"100",align:"center"},{colKey:"zh_cost",title:"转化成本",width:"100",align:"center"},{colKey:"cancelPlant",title:"自动关停",width:"100",align:"center"},{colKey:"packageInfo.packageName",title:"所属计划包",width:"180",align:"center"},{colKey:"noCostTime",title:"无消耗时长",width:"200",align:"center",sorter:!0,sortType:"all"},{colKey:"updatedAt",title:"更新时间",width:"200",align:"center"},{colKey:"createdCancelTime",title:"创建/关闭时间",width:"240"},{colKey:"startEndTime",title:"加热开始/结束时间",width:"240"},{colKey:"startCostTime",title:"开始消耗时间",width:"240",align:"center"},{colKey:"newMemberDepName",title:"所属部门",width:"140",align:"center"}],ma=(e=>(x("data-v-71b8db16"),e=e(),C(),e))((()=>f("div",{class:"titleBox"},[f("div",{class:"textBox"},[f("div",{class:"leftBorder"}),f("div",{class:"titleText",style:{color:"#000"}}," 数据概览 ")])],-1))),fa={style:{padding:"0 15px 0 0"}},ya=a(i({__name:"data-overview",setup(a,{expose:t}){const l=u({}),o=u(!1),n=u(1),s=(e,a,t,l,o)=>({name:e,data:o,type:"line",smooth:!0,yAxisIndex:l,itemStyle:{color:a},emphasis:{focus:"series",itemStyle:{color:a,borderWidth:2,borderColor:t}},lineStyle:{width:2,color:a},showSymbol:!1,areaStyle:{opacity:.1,color:a}});e.exports.useI18n();const{loading:i,setLoading:x}=he(!0);ia();const C=u([]),I=u(),T=u(),S=u([]),N=u([]),D=u([]),q=u([]),{chartOption:Y}=ua((e=>({grid:{left:"5.6%",right:"4",top:"40",bottom:"40"},legend:{data:["消耗","订单数","GMV","ROI"],selected:{}},xAxis:{type:"category",offset:2,data:C.value,boundaryGap:!1,axisLabel:{color:"#4E5969",formatter:(e,a)=>0===a||a===C.value.length-1?"":`${e}`},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1},axisPointer:{show:!0,lineStyle:{color:"#23ADFF",width:2}}},yAxis:[{show:!1,type:"value",axisLine:{show:!1},axisLabel:{formatter:(e,a)=>0===a?String(e):e>1e4?e/1e4+"w":e},splitLine:{lineStyle:{color:e?"#2E2E30":"#F2F3F5"}}},{show:!1,type:"value",axisLine:{show:!1},axisLabel:{formatter:(e,a)=>0===a?String(e):e>1e4?e/1e4+"w":e},splitLine:{lineStyle:{color:e?"#2E2E30":"#F2F3F5"}}},{show:!1,type:"value",axisLine:{show:!1},axisLabel:{formatter:(e,a)=>0===a?String(e):e>1e4?e/1e4+"w":e},splitLine:{lineStyle:{color:e?"#2E2E30":"#F2F3F5"}}},{show:!1,type:"value",axisLine:{show:!1},axisLabel:{formatter:(e,a)=>0===a?String(e):e>1e4?e/1e4+"w":e},splitLine:{lineStyle:{color:e?"#2E2E30":"#F2F3F5"}}}],tooltip:{trigger:"axis",formatter(e){const[a]=e;return`<div>\n            <p class="tooltip-title">${a.axisValueLabel}</p>\n            ${t=e,t.map((e=>`<div class="content-panel">\n        <p>\n          <span style="background-color: ${e.color}" class="tooltip-item-icon"></span><span>${e.seriesName}</span>\n        </p>\n        <span class="tooltip-value">${e.value.toLocaleString()}</span>\n      </div>`)).reverse().join("")}\n          </div>`;var t},className:"echarts-tooltip-diy"},graphic:{elements:[{type:"text",left:"2.6%",bottom:"18",style:{text:I.value,textAlign:"center",fill:"#4E5969",fontSize:12}},{type:"text",right:"0",bottom:"18",style:{text:T.value,textAlign:"center",fill:"#4E5969",fontSize:12}}]},series:[s("ROI","#3469FF","#E8F3FF",3,q.value),s("GMV","#33D1C9","#E8FFFB",2,D.value),s("订单数","#F77234","#FFE4BA",0,N.value),s("消耗","#722ED1","#F5E8FF",1,S.value)]})));u([]),x(!0);const O=async()=>{x(!0);try{if(S.value=[],N.value=[],D.value=[],q.value=[],C.value=[],1===n.value){C.value.push("0:00"),S.value.push(0),N.value.push(0),D.value.push(0),q.value.push(0);const{data:e}=await Ie({...l.value,reportDate:l.value.startDate});e.grid&&e.grid.forEach(((a,t)=>{0===t?(S.value.push(a.cost||0),N.value.push(a.productOrderCount||0),D.value.push(a.productPlaceorderGmv||0),a.productPlaceorderGmv>0&&a.cost>0?q.value.push(a.productPlaceorderGmv/a.cost):q.value.push(0)):(S.value.push(a.cost-e.grid[t-1].cost||0),N.value.push(a.productOrderCount-e.grid[t-1].productOrderCount||0),D.value.push(a.productPlaceorderGmv-e.grid[t-1].productPlaceorderGmv||0),a.productPlaceorderGmv-e.grid[t-1].productPlaceorderGmv>0&&a.cost-e.grid[t-1].cost>0?q.value.push((a.productPlaceorderGmv-e.grid[t-1].productPlaceorderGmv)/(a.cost-e.grid[t-1].cost)):q.value.push(0)),C.value.push(`${a.reportHourStr}`)}))}else{const{data:e}=await Te({...l.value});e.grid&&e.grid.forEach((e=>{S.value.push(e.cost||0),N.value.push(e.productOrderCount||0),D.value.push(e.productPlaceorderGmv||0),e.productPlaceorderGmv>0&&e.cost>0?q.value.push(e.productPlaceorderGmv/e.cost):q.value.push(0),C.value.push(g(e.reportDate).format("M.D"))}))}}catch(e){}finally{x(!1)}};return t({setChartsData:e=>{g(e.startDate).format("YYYYMMDD")===g(e.endDate).format("YYYYMMDD")?(n.value=1,o.value=!1):(n.value=2,o.value=!0),l.value=e,O()},setParamsData:e=>{e.startDate,e.endDate}}),(e,a)=>{const t=h,l=_,s=b,u=w,g=r("Chart"),x=k;return d(),c(x,{loading:y(i),style:{width:"100%"}},{default:p((()=>[v(u,{class:"banner",justify:"space-between"},{default:p((()=>[v(t,{flex:"250px",class:"accountCheck"},{default:p((()=>[ma])),_:1}),v(t,{flex:"170px"},{default:p((()=>[v(s,{"model-value":n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),type:"button",onChange:a[1]||(a[1]=e=>O())},{default:p((()=>[v(l,{value:1,disabled:o.value},{default:p((()=>[m("时段统计")])),_:1},8,["disabled"]),v(l,{value:2},{default:p((()=>[m("按天统计")])),_:1})])),_:1},8,["model-value"])])),_:1})])),_:1}),f("div",fa,[v(g,{style:{height:"328px","margin-top":"10px"},option:y(Y)},null,8,["option"])])])),_:1},8,["loading"])}}}),[["__scopeId","data-v-71b8db16"]]),ga=e=>(x("data-v-76093f2a"),e=e(),C(),e),ha={class:"container"},_a={class:""},ba={class:"goodStatusBox"},wa=["onClick"],ka={key:0},xa={key:0},Ca={class:"nameBox"},Ia={class:"proCode",style:{display:"flex","align-items":"center"}},Ta={class:"proCode",style:{display:"flex","align-items":"center"}},Sa=ga((()=>f("div",{class:"labelText"},"投手号搜索：",-1))),Na=ga((()=>f("div",{class:"labelText"},"计划包：",-1))),Da=ga((()=>f("div",{class:"labelText"},"被投号搜索：",-1))),qa=ga((()=>f("p",null,"更新时间：指的是计划最后一次进行修改或更新的时间(即数据产生了变动，比如：消耗、订单…等等)",-1))),Ya=ga((()=>f("p",null,"创建时间：指的是计划创建的时间，不会因为后续的修改而改变",-1))),Oa={class:"numBox2"},Va={class:"titleBox"},ja=["src"],Pa={class:"n"},Ma={key:0,class:"rmb"},za={class:"name"},Ka={key:0,class:"official iconfont"},Ua=ga((()=>f("span",{class:"icon-shipinhao"},null,-1))),Aa={class:"proCode",style:{display:"flex","align-items":"center"}},Ga=ga((()=>f("br",null,null,-1))),Ha=ga((()=>f("br",null,null,-1))),Ba={key:0},Fa={class:"upai_content"},Ea=ga((()=>f("div",{class:"title"}," 加热数据 ",-1))),Ra={class:"numBox"},$a={class:"titleBox"},Ja=["src"],La={class:"n"},Wa={key:0,class:"rmb"},Qa={class:"upai_content"},Xa=ga((()=>f("div",{class:"title"}," 加热信息 ",-1))),Za={class:"upai_content"},et=ga((()=>f("div",{class:"title"}," 支付信息 ",-1))),at={class:"pagination"},tt=a(i({__name:"data",setup(e,{expose:a}){const i=u(),x=u(!1),C=u(),Ie=u({name:null,type:1,firstType:1,firstVal:0,secondType:1,secondVal:0,flagType:1}),Te=u(),ia=["","#7bc616","#165dff","#00b42a","#00b42a","#eb0aa4","#f53f3f","#f53f3f","#f53f3f","#f53f3f"];u(!1),u({plantId:null,groupId:null,groupType:1,addName:null}),u();const ua=u([]),ma=u([]),fa=u([]);t();const ga=u("(平均消耗:-/分钟)");(async()=>{try{const{data:e}=await na();if(e.grid){const a=oa(e.grid)||[];a.unshift({memberDepId:-1,memberDepName:"全部"}),ma.value=a}else{const e=[];e.unshift({memberDepId:-1,memberDepName:"全部"}),ma.value=e}}catch(e){}})();(async()=>{const{data:e}=await Se({pageIndex:1,pageSize:200});fa.value=e.grid})();(async()=>{const{data:e}=await _e({pageIndex:1,pageSize:200});ua.value=e.grid||[]})();const tt=u(!1),lt=u({plantId:null,packageId:null,packageType:1,addName:null}),ot=u(),nt=u([]),st=u([]);(async()=>{const{data:e}=await be({pageIndex:1,pageSize:200});nt.value=e.grid||[]})();const it=async e=>{const a={pageSize:200,pageIndex:1,name:e},{data:t}=await Ce({...a});t.grid&&(st.value=t.grid.map((e=>({packageId:`${e.packageId}`,packageName:e.packageName}))))};it();const ut=async e=>{it(e)},rt=[{label:"当日",value:()=>[g().startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"昨日",value:()=>[g().add(-1,"day").startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().add(-1,"day").endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"近一周",value:()=>[g().add(-1,"week").startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().add(-1,"day").endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"近一月",value:()=>[g().add(-1,"month").startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().add(-1,"day").endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"本月",value:()=>[g().startOf("month").startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().endOf("date").format("YYYY-MM-DD HH:mm:ss")]}],dt={x:"150%"},ct=u(!0),pt=()=>{ct.value=!ct.value},vt=u(!1),mt=u(!1),ft=u(""),yt=u('[{"搞笑":"1083"},{"亲子":"1084"},{"二次元":"1085"},{"明星名人":"1086"},{"旅行风景":"1087"},{"舞蹈":"1088"},{"音乐":"1089"},{"运动":"1090"},{"影视综艺":"1091"},{"时尚":"1092"},{"美食":"1093"},{"萌宠":"1094"},{"动物":"1095"},{"游戏":"1096"},{"科技":"1097"},{"工业/机械/施工":"1098"},{"车":"1099"},{"生活":"1100"},{"新闻资讯":"1101"},{"知识":"1102"},{"悬疑/侦探剧场":"1103"},{"情感":"1104"},{"才艺":"1105"},{"生活技巧":"1106"}]');yt.value=JSON.parse(yt.value);const gt=new Map;yt.value.forEach(((e,a)=>{gt.set(e[Object.keys(e)],Object.keys(e)[0])}));const{loading:ht,setLoading:_t}=he(!0),bt={current:1,pageIndex:1,pageSize:30,defaultPageSize:30,pageSizeOptions:[10,30,50,100],total:0,defaultCurrent:1,page:1},wt=I({...bt}),kt=u([]),xt=u(!1),Ct=I({pageIndex:1,pageSize:50,total:0}),It=()=>({startDate:g().startOf("date").format("YYYY-MM-DD HH:mm:ss"),endDate:g().endOf("date").format("YYYY-MM-DD HH:mm:ss"),pageIndex:1,pageSize:10,dateType:2,taskStatus:-1,memberDepId:-1}),Tt=u([]),St=T(JSON.parse(JSON.stringify(da))),Nt=T(JSON.parse(JSON.stringify(pa))),Dt=u([]),qt=T(JSON.parse(JSON.stringify(va))),Yt=T(JSON.parse(JSON.stringify(ca))),Ot=T(JSON.parse(JSON.stringify(ca)));function Vt(e){const a=[];e.filter((e=>{St.value.fixColums.includes(e)||a.push(e)})),a.length?s({customColumnValue:JSON.stringify(a),type:2}):s({customColumnValue:"[]",type:2})}S((()=>{n({type:2}).then((({data:e})=>{if(e.customColumnValue){const a=JSON.parse(e.customColumnValue);Dt.value=JSON.parse(JSON.stringify([...St.value.fixColums,...a])),St.value.defaultColumns=a}else Dt.value=St.value.fixColums.concat(St.value.defaultColumns)}))}));const jt=async e=>{ft.value="计划删除后无法复原，请确认是否删除",Gt.value.cost&&(ft.value="删除计划中有包含部分数据，删除可能导致投放数据异常，请谨慎操作确认是否删除"),mt.value=e},Pt=async e=>{0!==Ht.value.length?(ft.value="计划删除后无法复原，请确认是否删除",Ht.value.forEach((e=>{"-"!==Le.find(At.value,["plantId",e]).cost&&(ft.value="删除计划中有包含部分数据，删除可能导致投放数据异常，请谨慎操作确认是否删除")})),vt.value=e):j.info("请先选择需要删除的计划")};qt.value.forEach((e=>{"row-select"===e.colKey||Tt.value.push(e.colKey)}));const Mt=u(!1),zt=u("新建计划包"),Kt=u(["","元","元","元","小时","","","小时"]),Ut=u(It()),At=u([]);u(0);const Gt=u(),Ht=u([]),Bt=u([]),Ft=$e(),Et=u([g().startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().endOf("date").format("YYYY-MM-DD HH:mm:ss")]),{taskId:Rt}=Ft.currentRoute.value.query||0,{packageId:$t,packageCreaedAt:Jt}=Ft.currentRoute.value.query||0,{videoId:Lt}=Ft.currentRoute.value.query||0;Number(Rt)>0&&(Ut.value.taskId=Rt),Number($t)>0&&(Ut.value.packageId=$t),Number(Lt)>0&&(Ut.value.videoId=Lt),Number(Jt)>0&&(Ut.value.startDate=g.unix(Number(Jt)).format("YYYY-MM-DD HH:mm:ss"),Et.value[0]=g.unix(Number(Jt)).format("YYYY-MM-DD HH:mm:ss"));const Wt=u(0);u(!1);const Qt=u(!1),Xt=u(""),Zt=u(0),el=u([{id:1,name:"计划列表"}]),al={1:"18-24岁",2:"25-29岁",3:"30-39岁",4:"40-49岁",5:"50岁以上"},tl=u(!1),ll=u(!1),ol=u(!1),nl=u(!1),sl=u([]),il=u(1),ul=u(0),rl=u(),dl=u(""),cl=async()=>{if(nl.value)return;let e=[],a={},t="";const l=20;switch(nl.value=!0,el.value[Wt.value].id){case 4:a=await ke({name:dl.value,pageIndex:il.value,pageSize:l}),e=a.data.grid,t="videoId";break;case 2:a=await _e({name:dl.value,pageIndex:il.value,pageSize:l}),e=a.data.grid,t="groupId";break;case 3:a=await we({name:dl.value,pageIndex:il.value,pageSize:l}),e=a.data.grid,t="goodsId";break;case 5:a=await We({sphName:dl.value,pageIndex:il.value,pageSize:l,sphType:1}),e=a.data.grid,t="sphId";break;case 6:a=await Se({name:dl.value,pageIndex:il.value,pageSize:l}),e=a.data.grid,t="investedId";break;case 7:a=await Fe({name:dl.value,pageIndex:il.value,pageSize:l,srType:2}),e=a.data.grid,t="srId";break;default:return sl.value=[],nl.value=!1,ol.value=!0,void(il.value=0)}null!=e?e.forEach(((e,a)=>{sl.value.push(e),0===a&&1===il.value&&(6===el.value[Wt.value].id?Ut.value[t]=e.id:Ut.value[t]=e[t])})):Ut.value[t]=-1,nl.value=!1,ol.value=!0,il.value+=1},pl=u([{t:"投放金额",key:"estimatedWecoinAmount",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"消耗金额",key:"cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"成交金额",key:"productPlaceorderGmv",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"成交订单数",key:"productOrderCount",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"成交ROI",key:"roi",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"佣金ROI",key:"yj_roi",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"空耗值",key:"airCost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"利润",key:"lr",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"千次展示成本",key:"qz_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"关注成本",key:"gz_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"点击成本",key:"click_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"转化成本",key:"zh_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"商品点击率",key:"click_rate",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"点击成交率",key:"cj_rate",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"点击数",key:"productClickCountUv",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"浏览数",key:"exposureCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"点赞数",key:"likeCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"关注数",key:"followCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1}]),vl=u([{t:"订单金额",key:"productPlaceorderGmv",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"订单数",key:"productOrderCount",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:1},{t:"消耗金额",key:"cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"平均客单价",key:"pjKdj",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"无消耗时长",key:"noCostTime",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:0},{t:"成交ROI",key:"roi",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"佣金ROI",key:"yj_roi",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"点击率",key:"click_rate",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"成交率",key:"cj_rate",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:3},{t:"空耗值",key:"airCost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2,tips:"截止上一次转化成功(即出单)到目前为止的消耗金额",tips2:"例如：计划加热中，消耗金额为500¥、出单为0，则空耗值为500"},{t:"千次展示成本",key:"qz_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"关注成本",key:"gz_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"点击成本",key:"click_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"转化成本",key:"zh_cost",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"利润",key:"lr",url:"https://img.adyinqing.com/upai_shop/sqolvvco1676629138552",n:0,type:2},{t:"点击数",key:"productClickCountUv",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"浏览数",key:"exposureCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"点赞数",key:"likeCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"关注数",key:"followCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1},{t:"评论数",key:"commentCount",url:"https://img.adyinqing.com/upai_shop/9vefp7lc1676629138525",n:0,type:1}]),ml=u([{label:"加热方式:",value:"",key:"promotionType",expandable:!1},{label:"性别:",value:"",key:"gender",expandable:!1},{label:"加热素材:",value:"",key:"materialFlag",expandable:!1},{label:"年龄:",value:"",key:"ageRange",expandable:!1},{label:"优先提升:",value:"",key:"promotionTarget",expandable:!1},{label:"区域:",value:"",key:"cityIds",expandable:!1},{label:"成交出价:",value:"",key:"wecoinBid",expandable:!1},{label:"兴趣:",value:"",key:"interestTag",expandable:!1},{label:"加热时长:",value:"",key:"duration",expandable:!1},{label:"粉丝层:",value:"",key:"videoTagArr",expandable:!1}]),fl=u([{label:"已支付微信豆:",value:"",key:"estimatedWecoinAmount",tips:"预计支付微信豆",expandable:!1},{label:"使用优惠:",value:"未使用",tips:"是否使用优惠券抵扣",key:"quota",expandable:!1},{label:"已返还微信豆:",value:"",tips:"计划完成消耗后官方退款返还的微信豆",key:"estimatedWecoinAmountBack",expandable:!1},{label:"补贴进度:",value:"无补贴",key:"",expandable:!1,tips:"-"},{label:"实际使用微信豆:",value:"",key:"costCoin",tips:"计划实际消耗微信豆",expandable:!1}]),yl=u([]),gl=u(!1),hl=u([]),_l=u([]),bl=u([]);(async()=>{const{data:e}=await We({pageIndex:1,pageSize:200,sphType:1});hl.value=e.grid})(),(async()=>{const{data:e}=await we({pageIndex:1,pageSize:200});_l.value=e.grid})(),(async()=>{const{data:e}=await ke({pageIndex:1,pageSize:200});bl.value=e.grid})();const wl=u(!1),kl=u([]),xl=u({oldShutdownStatus:0,shutdownStatus:null,shutdownSetId:null,plantId:0}),Cl=async()=>{const{data:e}=await Fe({pageIndex:1,pageSize:200,srType:2});kl.value=e.grid||[]};Cl();const Il=async e=>{var a;await(null==(a=Te.value)?void 0:a.validate())?e(!1):(1===Ie.value.type?(await Ee({...Ie.value,srType:2}),j.success({content:"添加关停策略成功",duration:5e3}),await Cl()):(await Re({...Ie.value,srType:2}),j.success({content:"修改关停策略成功",duration:5e3}),await Cl()),Ie.value.name=null,window.setTimeout((()=>{e()}),300))},Tl=()=>{Ie.value.name=Ae[Ie.value.firstType]+Ie.value.firstVal+Ge[Ie.value.flagType]+Ae[Ie.value.secondType]+Ie.value.secondVal},Sl=async e=>{if(e)xl.value.shutdownStatus=0!==e.shutdownStatus,xl.value.shutdownSetId=[],e.shutdownSetId&&e.shutdownSetId.split(",").forEach((e=>{xl.value.shutdownSetId.push(Number(e))})),xl.value.plantId=e.plantId,xl.value.oldShutdownStatus=e.shutdownStatus,Ht.value=[e.plantId];else{if(0===Ht.value.length)return void j.info("请先选择需自动关停配置的计划");xl.value.shutdownStatus=!0,xl.value.shutdownSetId=[]}wl.value=!0},Nl=async e=>{null!=xl.value.shutdownSetId&&xl.value.shutdownSetId.length>0&&!1===xl.value.shutdownStatus&&(xl.value.shutdownStatus=!0),0===xl.value.shutdownSetId.length&&!0===xl.value.shutdownStatus&&(xl.value.shutdownStatus=!1)},Dl=async(e,a)=>{Ht.value=e,Bt.value=a.selectedRowData.map((e=>e))},ql=e=>{e?(Ut.value.startDate=e[0],Ut.value.endDate=e[1]):(Ut.value.startDate=g().add(-3,"month").format("YYYY-MM-DD").toString(),Ut.value.endDate=g().format("YYYY-MM-DD").toString()),Kl()},Yl=e=>isNaN(e)||0===Number(e)||e===1/0?0:Number(e).toFixed(2),Ol=e=>isNaN(e)||0===Number(e)||e===1/0?"-":Number(e).toFixed(2),Vl=e=>isNaN(e)||0===Number(e)?"-":Number(100*e).toFixed(2),jl=async e=>{_t(!0);try{(async e=>{var a;const{data:t}=await je(e),l=t;l.pjKdj=Yl(l.productPlaceorderGmv/l.productOrderCount),l.roi=Yl(l.productPlaceorderGmv/l.cost),l.yj_roi=Yl(l.productPlaceorderGmv*(l.yjl/l.plantCount/100)/l.cost),l.click_rate=`${Yl(l.productClickCountUv/l.exposureCount*100)}%`,l.cj_rate=`${Yl(l.productOrderCount/l.productClickCountUv*100)}%`,l.qz_cost=Yl(l.cost/l.exposureCount*1e3),l.gz_cost=Yl(l.cost/l.followCount),l.click_cost=Yl(l.cost/l.productClickCountUv),l.zh_cost=Yl(l.cost/l.productOrderCount),l.lr=Yl(l.productPlaceorderGmv*(l.yjl/l.plantCount/100)-l.cost),l.noCostTime=`${Yl(l.noCostTime/60)}分`,pl.value.forEach((e=>{e.n=l[e.key]||"-"})),null==(a=i.value)||a.setChartsData(Ut.value)})(e);const{data:a}=await Ne(e);a.grid&&a.grid.forEach(((e,a)=>{if(e.sonDepInfo){const a=e.sonDepInfo.depParentId?Le.find(Pl.value,["memberDepId",e.sonDepInfo.depParentId]).memberDepName:"";e.newMemberDepName=""+(e.sonDepInfo?`${e.sonDepInfo.depParentId?a:""}${e.sonDepInfo.depParentId?"/":""}${e.sonDepInfo.memberDepName}`:"")}e.key=String(a+1),e.startCostTime=e.startTime?g(e.startTime).add(e.noCostTime,"second").format("YYYY-MM-DD HH:mm:ss"):"-",e.productPlaceorderGmv>0?e.lr=Ol(e.productPlaceorderGmv*(e.yjl/100)-e.cost):e.lr=0,e.cost=Ol(e.cost),e.productPlaceorderGmv=Ol(e.productPlaceorderGmv),e.roi=Ol(e.productPlaceorderGmv/e.cost),e.yl_roi=Ol(e.productPlaceorderGmv*(e.yjl/100)/e.cost),e.airCost=Ol(e.airCost),e.targetType=He[e.targetType],e.wecoinBid=e.wecoinBid>0?e.wecoinBid:"智能",e.duration=e.duration/3600+"小时",e.click_rate="-"===Vl(e.productClickCountUv/e.exposureCount)?"-":`${Vl(e.productClickCountUv/e.exposureCount)}%`,e.qan_cost=Ol(e.cost/e.exposureCount*1e3),e.click_cost=Ol(e.cost/e.productClickCountUv),e.zh_cost=Ol(e.cost/e.productOrderCount),e.shutdownSwitch=0!==e.shutdownStatus})),At.value=a.grid||[],wt.current=e.pageIndex,wt.pageIndex=e.pageIndex,wt.total=a.total}catch(a){}finally{_t(!1)}};u();const Pl=u(),Ml=async()=>{const e={...Ut.value},a=[];for(let o=0;o<15;o++){const t=new Promise((async a=>{e.pageSize=200,e.pageIndex=o+1;const{data:t}=await Ne({...e});a(t.grid)}));a.push(t)}const t=`计划报表导出${g().format("YYMMDDhhmmss")}.xls`,l=[];await Promise.all(a).then((e=>{e.forEach((e=>{e&&e.forEach((e=>{l.push(e)}))}))}));l.forEach((e=>{e.productPlaceorderGmv>0?e.lr=Ol(e.productPlaceorderGmv*(e.yjl/100)-e.cost):e.lr="-",e.plantStatus=Ke[e.plantStatus]||"-",e.sphName=e.sphInfo.sphName,e.costRate=Number(Yl(e.cost/e.estimatedWecoinAmount)),e.cost=Number(Ol(e.cost)),e.productOrderCount=Number(Ol(e.productOrderCount)),e.productPlaceorderGmv=Number(Ol(e.productPlaceorderGmv)),e.roi=Ol(e.roi),e.ylRoi=Ol(e.ylRoi),e.yjl=Ol(e.yjl),e.airCost=Ol(e.airCost),e.productClickCountUv="-"===Ol(e.productClickCountUv)?"-":parseInt(Ol(e.productClickCountUv),10),e.exposureCount="-"===Ol(e.exposureCount)?"-":parseInt(Ol(e.exposureCount),10),e.targetType=He[e.targetType],e.wecoinBid=e.wecoinBid>0?e.wecoinBid:"智能",e.duration=e.duration/3600+"小时",e.productClickCountUvRate="-"===Vl(e.productClickCountUv/e.exposureCount)?"-":`${Vl(e.productClickCountUv/e.exposureCount)}%`,e.qRate=Ol(e.cost/e.exposureCount*1e3),e.cRate=Ol(e.cost/e.productClickCountUv),e.zRate=Ol(e.cost/e.productOrderCount)})),function(e,a,t="表格"){e.forEach((e=>{for(const t in e)a[t]&&(e[a[t]]=e[t],e[a[t]]=e[a[t]]?e[a[t]]:"-"),delete e[t]}));const l=t,o=ta.utils.book_new(),n=ta.utils.json_to_sheet(e,{header:Object.values(a)});o.SheetNames.push(l),o.Sheets[l]=n;const s={bookType:"xlsx",bookSST:!1,type:"binary",cellStyles:!0,defaultCellStyle:{font:{name:"Verdana",sz:13,color:"FF00FF88"},fill:{fgColor:{rgb:"FFFFAA00"}}},showGridLines:!1},i=ta.write(o,s),u=new Blob([ra(i)],{type:"application/octet-stream"});la.saveAs(u,`${t}.xlsx`)}(l,{plantName:"计划名称",plantCode:"计划ID",plantStatus:"计划状态",sphName:"投放号",estimatedWecoinAmount:"投放金额",costRate:"消耗比例",cost:"消耗金额",productOrderCount:"订单数",productPlaceorderGmv:"营业额",lr:"利润",roi:"ROI",ylRoi:"佣金ROI",yjl:"佣金率",airCost:"空耗值",productClickCountUv:"商品点击",exposureCount:"浏览",targetType:"投放目标",wecoinBid:"出价",duration:"投放时长",productClickCountUvRate:"点击率",qRate:"千展成本",cRate:"点击成本",zRate:"转化成本",updatedAt:"更新时间",createdAt:"创建时间",cancelTime:"关闭时间",startTime:"加热开始时间",endTime:"加热结束时间",videoSignature:"视频描述"},t)},zl=e=>{bt.pageIndex=e.current,bt.current=e.current,bt.pageSize=e.pageSize,wt.pageIndex=e.current,wt.current=e.current,wt.pageSize=e.pageSize,jl({...Ut.value,...bt})},Kl=()=>{zl({current:wt.pageIndex,pageSize:wt.pageSize})},Ul=async()=>{const e=await De({});e.success?j.success("刷新成功"):j.success(e.message)},Al=async e=>{e?(Ut.value.orderKey=e.sortBy,Ut.value.orderSort=e.descending?"DESC":"ASC"):Ut.value.orderSort=null,Kl()},Gl=async e=>{try{let e=0;!0===xl.value.shutdownStatus&&(e=0===xl.value.oldShutdownStatus?1:xl.value.oldShutdownStatus);const{data:a}=await qe({plantId:Ht.value.join(","),shutdownSetId:xl.value.shutdownSetId.join(","),shutdownStatus:e});j.success({content:"更新关停策略成功",duration:5e3})}catch(a){}finally{wl.value=!1,Kl()}e(!1)},Hl=async e=>{if(e){const{data:a,code:t}=await Ye({plantId:`${e}`});200===t&&(j.success("删除计划成功。"),tl.value=!1,Kl())}else{const e=Ht.value.join(","),{data:a,code:t}=await Ye({plantId:e});200===t&&(j.success("批量删除计划成功。"),Kl())}},Bl=async()=>{clearInterval(rl.value)},Fl=async e=>{if(0===Ht.value.length)return j.info("请先选择需要关闭的计划"),void e(!0);try{Xl(Bt.value).then((async e=>{const{data:a}=await Qe({plantId:Ht.value.join(",")});j.success({content:"请求关停成功",duration:5e3}),Kl()})).catch((async e=>{var a;const t=Le.filter(e.grid,["sphStatus",2]),l=Le.filter(e.grid,["sphStatus",1]),o=t.map((e=>e.sphName)),n=[];for(let s=0;s<l.length;s+=1)Bt.value.forEach((e=>{l[s].sphId===e.sphInfo.sphId&&n.push(e.plantId)}));if(n.length>0){const{data:e}=await Qe({plantId:n.join(",")})}Kl(),null==(a=C.value)||a.showModel(o,!0)}))}catch(a){return void e(!0)}e(!0)},El=async()=>{xt.value=!0;const{data:e}=await Pe({plantId:Gt.value.plantId,pageIndex:Ct.pageIndex,pageSize:Ct.pageSize});kt.value=e.grid,Ct.total=e.total,xt.value=!1;let a="";if(e.grid){a=g(e.grid[0].createAt);const t=a.diff(Ll.value,"minute");ga.value=Wl.value?`(平均消耗:${Ol(t/Wl.value)}/分钟)`:"(平均消耗:-/分钟)"}else ga.value="(平均消耗:-/分钟)"},Rl=e=>{Ct.pageIndex=e,El()};function $l(e){let a=parseInt(e/60/60%24),t=parseInt(e/60%60),l=parseInt(e%60);return a=a<10?`0${a}`:a,t=t<10?`0${t}`:t,l=l<10?`0${l}`:l,`${a}:${t}:${l}`}const Jl=u();fetch("https://img.adyinqing.com/json/tag.json").then((e=>e.json())).then((e=>{Jl.value=e}));const Ll=u(),Wl=u(),Ql=async e=>{tl.value=!0,ll.value=!0;const{data:a}=await Oe({plantId:e.plantId});Gt.value=a.info;const t=Gt.value;Ll.value=g(t.startTime).add(t.noCostTime,"second").format("YYYY-MM-DD HH:mm:ss"),Wl.value=t.cost,t.pjKdj=Yl(t.productPlaceorderGmv/t.productOrderCount),t.roi=Yl(t.productPlaceorderGmv/t.cost),t.yj_roi=Yl(t.productPlaceorderGmv*(t.yjl/100)/t.cost),t.click_rate=`${Yl(t.productClickCountUv/t.exposureCount*100)}%`,t.cj_rate=`${Yl(t.productOrderCount/t.productClickCountUv*100)}%`,t.qz_cost=Yl(t.cost/t.exposureCount*1e3),t.gz_cost=Yl(t.cost/t.followCount),t.click_cost=Yl(t.cost/t.productClickCountUv),t.zh_cost=Yl(t.cost/t.productOrderCount),t.lr=Yl(t.productPlaceorderGmv-t.cost),t.noCostTime=`${$l(t.noCostTime)}`,vl.value.forEach((e=>{e.n=t[e.key]||"-"}));const l={};let o={};if(l.duration=t.duration>0?t.duration/3600+"小时":"-",l.promotionTarget=He[t.targetType],l.wecoinBid=t.wecoinBid>0?t.wecoinBid:"智能",t.taskInfo&&t.taskInfo.reqJson){o=JSON.parse(t.taskInfo.reqJson),o.livePromotionOrderInfo.suggest&&o.livePromotionOrderInfo.suggest.similarUsernameList.length>0?l.videoTagArr=o.engineInfo.videoTagArr.join(","):l.videoTagArr="不限",l.promotionType=o.livePromotionOrderInfo.suggest.wecoinBid?"控成本加热":"放量加热",l.materialFlag=Be[o.livePromotionOrderInfo.materialFlag]||"-",0===o.livePromotionOrderInfo.suggest.gender.length?l.gender="不限":l.gender=0===o.livePromotionOrderInfo.suggest.gender.indexOf(1)?"男":"女",0===o.livePromotionOrderInfo.suggest.ageRange.length?l.ageRange="不限":(l.ageRange="",o.livePromotionOrderInfo.suggest.ageRange.forEach((e=>{l.ageRange+=`${al[e]}、`}))),0===o.livePromotionOrderInfo.suggest.interestTagV3.length?l.interestTag="不限":(l.interestTag="",o.livePromotionOrderInfo.suggest.interestTagV3.forEach((e=>{e.interestTagName?l.interestTag+=`${e.interestTagName}、`:l.interestTag="-"})));const e=[...ea,...aa];0===o.livePromotionOrderInfo.suggest.cityIds.length?l.cityIds="不限":(l.cityIds="",o.livePromotionOrderInfo.suggest.cityIds.forEach((a=>{var t;l.cityIds+=`${null==(t=Le.find(e,["code",a]))?void 0:t.name}、`})))}ml.value.forEach((e=>{"cityIds"===e.key&&"不限"!==l[e.key]&&(e.expandable=!0),"interestTag"===e.key&&"不限"!==l[e.key]&&(e.expandable=!0),e.value=l[e.key]||"-"})),t.costCoin=parseInt(10*t.cost,10),t.estimatedWecoinAmount*=10,t.estimatedWecoinAmountBack=t.cost>0?t.estimatedWecoinAmount-t.costCoin:0,fl.value.forEach((e=>{""!==e.key&&(e.value=t[e.key]?`${t[e.key]}`:"-","quota"===e.key&&(e.value=t.voucherInfo?`已抵扣${t.voucherInfo[e.key]}微信豆`:"未使用"))})),ll.value=!1,(async()=>{gl.value=!0;const{data:e}=await Me({plantId:Gt.value.plantId,pageIndex:1,pageSize:200});yl.value=e.grid,gl.value=!1})(),El()},Xl=async e=>{let a=e.map((e=>e.sphId));a=[...new Set(a)];const{data:t}=await Xe({sphId:a});return new Promise(((e,a)=>{let l=!1;for(let o=0;o<t.grid.length;o++)if(2===t.grid[o].sphStatus){l=!0;break}l?a(t):e(t)}))},Zl=e=>{Xl([e]).then((a=>{let t="undefined";3===e.sphInfo.sphUserType&&(t=e.sphInfo.sphUniqid),Qt.value=!0,Xt.value=`https://channels.weixin.qq.com/promote/pages/mobile_pay?promotionId=${e.plantCode}&type=live&userType=${e.sphInfo.sphUserType}&corproateId=${t}`,(async e=>{rl.value=setInterval((async function(){const{data:a}=await Ze({sphId:e.sphId,promotionId:e.plantCode});1!==Number(a.data.order.orderInfo.status)&&(clearInterval(rl.value),j.success({content:"当前订单已支付",duration:5e3}),Qt.value=!1,Kl()),2===Number(a.data.order.orderInfo.status)&&(clearInterval(rl.value),j.success({content:"订单支付成功",duration:5e3}),Qt.value=!1,Kl())}),1500)})(e)})).catch((async e=>{var a;const t=e.grid.map((e=>e.sphName));null==(a=C.value)||a.showModel(t)}))},eo=async e=>{var a;if(await(null==(a=ot.value)?void 0:a.validate()))e(!1);else{try{const{data:e}=await qe({plantId:Ht.value.join(","),packageId:lt.value.packageId,packageType:lt.value.packageType,addName:lt.value.addName});j.success({content:"更新计划包成功",duration:5e3})}catch(t){}finally{wl.value=!1,Kl()}e(!1),tt.value=!1}},ao=async e=>{localStorage.setItem("liveplant-disPlayColumns",JSON.stringify(e))};return(async()=>{const{data:e}=await sa();return new Promise(((a,t)=>{e.grid&&(Pl.value=e.grid.map((e=>({memberDepId:e.memberDepId,memberDepName:e.memberDepName})))),a(Pl.value)}))})().then((e=>{jl({...Ut.value})})),a({fetchData:jl}),(e,a)=>{const t=r("Breadcrumb"),n=h,s=w,u=k,I=P,T=M,S=r("icon-arrow-fall"),he=r("icon-arrow-rise"),_e=z,be=K,we=U,ke=me,Ce=A,Se=fe,Ne=G,De=H,qe=ye,Ye=B,Oe=F,je=E,Pe=R,Me=ge,He=$,Be=J,Fe=r("t-option"),Ee=r("t-select"),Re=L,$e=W,Le=Q,We=X,Xe=Z,Ze=ee,ea=r("icon-refresh"),aa=r("icon-settings"),ta=ae,la=r("icon-unordered-list"),oa=r("icon-exclamation-circle-fill"),na=te,sa=le,ua=oe,ra=r("icon-edit"),da=r("t-table"),ca=_,pa=b,yt=ne,gt=r("icon-plus"),_t=se,bt=r("icon-question-circle-fill"),Tt=ie,Bt=ue,Rt=re,$t=de,Jt=ce,Lt=pe,al=ve;return d(),N("div",ha,[f("div",_a,[v(t,{items:["投流管理","投放数据"]}),v(s,null,{default:p((()=>[v(n,{flex:1},{default:p((()=>[f("div",ba,[(d(!0),N(D,null,q(el.value,((e,a)=>(d(),N("div",{key:a,class:V(["btn tabText",{active:Wt.value===a}]),onClick:e=>(async e=>{Wt.value=e,sl.value=[],ol.value=!1,il.value=1,ul.value=0,nl.value=!1;const a=Ut.value;Ut.value=It(),Ut.value.startDate=a.startDate,Ut.value.endDate=a.endDate,await cl(),await Kl()})(a)},O(e.name),11,wa)))),128))])])),_:1})])),_:1}),v(s,{gutter:24},{default:p((()=>[0!==Wt.value?(d(),c(n,{key:0,span:5,xl:{span:5},xxl:{span:4}},{default:p((()=>[v(Oe,{class:"general-card-upai2 plantLeftItem",style:{width:"100%"}},{default:p((()=>[v(Ye,{hoverable:!0,scrollbar:!0,bordered:!1,"max-height":1537,onReachBottom:cl},{"scroll-loading":p((()=>[ol.value?(d(),N("div",ka,"暂无更多数据")):(d(),c(u,{key:1}))])),default:p((()=>[v(I,{modelValue:dl.value,"onUpdate:modelValue":a[0]||(a[0]=e=>dl.value=e),placeholder:"请输入名称搜索","search-button":"",style:{"margin-bottom":"10px"},onPressEnter:a[1]||(a[1]=e=>{sl.value=[],il.value=1,cl()}),onSearch:a[2]||(a[2]=e=>{sl.value=[],il.value=1,cl()})},null,8,["modelValue"]),(d(!0),N(D,null,q(sl.value,((e,a)=>(d(),c(qe,{key:a,class:V({"plantTab-select":ul.value===a}),onClick:t=>(async(e,a)=>{ul.value=a;const t=["","","groupId","goodsId","videoId","sphId","investedId","srId"],l=el.value[Wt.value].id;6===l?(Ut.value[t[l]]=e.id,Ut.value.sphId=0):Ut.value[t[l]]=e[t[l]],await Kl()})(e,a)},{default:p((()=>[v(we,{style:{"margin-bottom":"10px"}},{default:p((()=>[2===el.value[Wt.value].id?(d(),N("div",xa,[v(we,{size:[0,0],align:"start"},{default:p((()=>[f("div",Ca,[v(T,{copyable:"",bold:9999!==e.sort,style:{"margin-bottom":"0"}},{default:p((()=>[m(O(e.groupName),1)])),_:2},1032,["bold"])]),v(be,{content:9999===e.sort?"取消置顶":"置顶分组"},{default:p((()=>[v(_e,{class:"zhiding",onClick:a=>(async e=>{await xe({groupId:e.groupId,name:e.groupName,sort:9999===e.sort?0:9999}),j.info(9999===e.sort?"取消置顶":"置顶成功"),sl.value=[],il.value=1,cl()})(e)},{icon:p((()=>[9999===e.sort?(d(),c(S,{key:0})):(d(),c(he,{key:1}))])),_:2},1032,["onClick"])])),_:2},1032,["content"])])),_:2},1024)])):Y("",!0),3===el.value[Wt.value].id?(d(),c(T,{key:1,style:{"margin-bottom":"0"},ellipsis:{rows:1,expandable:!0}},{default:p((()=>[m(O(e.goodsName?e.goodsName:"-"),1)])),_:2},1024)):Y("",!0),7===el.value[Wt.value].id?(d(),c(T,{key:2,style:{"margin-bottom":"0"},ellipsis:{rows:2,expandable:!1}},{default:p((()=>[m(O(e.srName?e.srName:"-"),1)])),_:2},1024)):Y("",!0),5===el.value[Wt.value].id?(d(),c(we,{key:3,direction:"vertical",fill:""},{default:p((()=>[f("div",Ia,[v(ke,{style:{"margin-right":"2px"},size:40,"image-url":e.sphAvatar},null,8,["image-url"]),v(we,{direction:"vertical",fill:""},{default:p((()=>[v(T,{style:{"margin-bottom":"0"}},{default:p((()=>[m(O(e.sphName),1)])),_:2},1024),v(T,{style:{"margin-bottom":"0"}},{default:p((()=>[m(" 备注："+O(e.sphRemark),1)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):Y("",!0),6===el.value[Wt.value].id?(d(),c(we,{key:4,direction:"vertical",fill:""},{default:p((()=>[f("div",Ta,[v(ke,{style:{"margin-right":"2px"},size:40,"image-url":e.videoAvatar},null,8,["image-url"]),v(we,{direction:"vertical",fill:""},{default:p((()=>[v(T,{style:{"margin-bottom":"0"}},{default:p((()=>[m(O(e.videoNickName),1)])),_:2},1024),v(T,{style:{"margin-bottom":"0"},ellipsis:{rows:1,expandable:!1}},{default:p((()=>[m(O(e.signature?e.signature:"-"),1)])),_:2},1024)])),_:2},1024)])])),_:2},1024)):Y("",!0),4===el.value[Wt.value].id?(d(),c(Ce,{key:5,class:"plantVideo",src:e.investedInfo,width:"48px",height:"64px"},null,8,["src"])):Y("",!0),4===el.value[Wt.value].id?(d(),c(we,{key:6,direction:"vertical",fill:""},{default:p((()=>[v(T,{ellipsis:{rows:2,expandable:!1}},{default:p((()=>[m(O(e.signature?e.signature:"-"),1)])),_:2},1024),v(T,{style:{"font-size":"10px"}},{default:p((()=>[m(O(e.createdAt),1)])),_:2},1024)])),_:2},1024)):Y("",!0)])),_:2},1024),7!==el.value[Wt.value].id?(d(),c(De,{key:0,size:"mini",column:2,layout:"inline-vertical",align:"left"},{default:p((()=>[v(Ne,{label:"消耗"},{default:p((()=>[v(Se,{value:e.cost||0,precision:2},null,8,["value"])])),_:2},1024),v(Ne,{label:"成交金额"},{default:p((()=>[v(Se,{value:e.productPlaceorderGmv||0,precision:2},null,8,["value"])])),_:2},1024),v(Ne,{label:"成交ROI"},{default:p((()=>[v(Se,{value:e.productPlaceorderGmv>0?e.productPlaceorderGmv/e.cost:0,precision:2},null,8,["value"])])),_:2},1024),v(Ne,{label:"利润"},{default:p((()=>[v(Se,{value:e.productPlaceorderGmv>0?e.productPlaceorderGmv-e.cost:0,precision:2},null,8,["value"])])),_:2},1024)])),_:2},1024)):Y("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})])),_:1})):Y("",!0),v(n,{span:0==Wt.value?24:19,xl:{span:0==Wt.value?24:19},xxl:{span:0==Wt.value?24:20}},{default:p((()=>[v(Oe,{class:"general-card-upai",style:{width:"100%"}},{default:p((()=>[v(s,null,{default:p((()=>[v(n,{flex:1},{default:p((()=>[v(We,{model:Ut.value,"auto-label-width":"","label-align":"left"},{default:p((()=>[v(s,{gutter:16},{default:p((()=>[v(n,{span:8},{default:p((()=>[v(Pe,{field:"plantName",label:"名称搜索","label-col-flex":"60px"},{default:p((()=>[v(je,{modelValue:Ut.value.plantName,"onUpdate:modelValue":a[3]||(a[3]=e=>Ut.value.plantName=e),placeholder:"请输入计划名称","allow-clear":"",onPressEnter:Kl},null,8,["modelValue"])])),_:1})])),_:1}),v(n,{span:8},{default:p((()=>[v(Pe,{field:"sphId",label:"状态搜索","label-col-flex":"60px"},{default:p((()=>[v(He,{modelValue:Ut.value.plantStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>Ut.value.plantStatus=e),"allow-clear":"",placeholder:"全部状态"},{default:p((()=>[(d(!0),N(D,null,q(y(ze)(y(Ke)),((e,a)=>(d(),c(Me,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),0===Wt.value?(d(),c(n,{key:0,span:8,"label-col-flex":"80px"},{default:p((()=>[v(Pe,{field:"sphId"},{label:p((()=>[Sa])),default:p((()=>[v(He,{modelValue:Ut.value.sphId,"onUpdate:modelValue":a[5]||(a[5]=e=>Ut.value.sphId=e),"allow-clear":"",placeholder:"全部投手号"},{default:p((()=>[(d(!0),N(D,null,q(hl.value,((e,a)=>(d(),c(Me,{key:a,label:e.sphName,value:e.sphId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})):Y("",!0),0===Wt.value?(d(),c(n,{key:1,span:8},{default:p((()=>[v(Pe,{field:"packageId","label-col-flex":"60px"},{label:p((()=>[Na])),default:p((()=>[v(He,{modelValue:Ut.value.packageId,"onUpdate:modelValue":a[6]||(a[6]=e=>Ut.value.packageId=e),"allow-search":"","allow-clear":"",placeholder:"输入计划包名称进行搜索",onSearch:ut,onClear:a[7]||(a[7]=e=>it(""))},{default:p((()=>[(d(!0),N(D,null,q(st.value,((e,a)=>(d(),c(Me,{key:a,label:e.packageName,value:e.packageId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})):Y("",!0),v(n,{span:8},{default:p((()=>[v(Pe,{field:"memberDepId",label:"所属部门","label-col-flex":"60px"},{default:p((()=>[v(Be,{modelValue:Ut.value.memberDepId,"onUpdate:modelValue":a[8]||(a[8]=e=>Ut.value.memberDepId=e),options:ma.value,"check-strictly":"","allow-clear":"","field-names":{value:"memberDepId",label:"memberDepName"},placeholder:"请选择所属部门",onClear:e.clearDep},null,8,["modelValue","options","onClear"])])),_:1})])),_:1}),v(n,{span:8},{default:p((()=>[v(Pe,{field:"investedId","label-col-flex":"80px"},{label:p((()=>[Da])),default:p((()=>[v(He,{modelValue:Ut.value.investedId,"onUpdate:modelValue":a[9]||(a[9]=e=>Ut.value.investedId=e),"allow-clear":"",placeholder:"全部被投号"},{default:p((()=>[(d(!0),N(D,null,q(fa.value,((e,a)=>(d(),c(Me,{key:a,label:e.nickName,value:e.investedId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),v(n,{span:10},{default:p((()=>[v(Pe,{field:"createdTime","label-col-flex":"80px"},{label:p((()=>[v(be,{title:""},{content:p((()=>[qa,Ya])),default:p((()=>[v(Ee,{modelValue:Ut.value.dateType,"onUpdate:modelValue":a[10]||(a[10]=e=>Ut.value.dateType=e),placeholder:"时间维度",style:{width:"99px","font-size":"12px"},onChange:a[11]||(a[11]=e=>Kl())},{default:p((()=>[v(Fe,{value:1,label:"创建时间"}),v(Fe,{value:2,label:"更新时间"})])),_:1},8,["modelValue"])])),_:1})])),default:p((()=>[v(Re,{modelValue:Et.value,"onUpdate:modelValue":a[12]||(a[12]=e=>Et.value=e),"show-time":"","default-value":[y(g)().startOf("date").format("YYYY-MM-DD HH:mm:ss"),y(g)().endOf("date").format("YYYY-MM-DD HH:mm:ss")],style:{width:"100%"},shortcuts:rt,"shortcuts-position":"left",onChange:ql},null,8,["modelValue","default-value"])])),_:1})])),_:1}),v(n,{span:6}),v(n,{span:8}),v(n,{span:8},{default:p((()=>[v(Pe,{field:"number","hide-label":!0},{default:p((()=>[v(we,{size:18},{default:p((()=>[v($e,{type:"primary",class:"searchBtn",onClick:Kl},{default:p((()=>[m(" 筛选 ")])),_:1}),v($e,{type:"outline",class:"refreshBtn",onClick:a[13]||(a[13]=e=>Kl())},{default:p((()=>[m(" 刷新 ")])),_:1}),v(Le,{type:"primary"},{default:p((()=>[v(_e,{href:"javascript:void(0)",onClick:a[14]||(a[14]=e=>(Ut.value=It(),void(Et.value=[g().startOf("date").format("YYYY-MM-DD HH:mm:ss"),g().endOf("date").format("YYYY-MM-DD HH:mm:ss")])))},{default:p((()=>[m("重置筛选条件")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1}),v(s,{style:{"margin-bottom":"16px"}},{default:p((()=>[v(n,{flex:"auto"},{default:p((()=>[v(Ze,{cols:6,"col-gap":12,"row-gap":12,class:"grid-demo-grid",collapsed:ct.value},{default:p((()=>[(d(!0),N(D,null,q(pl.value,((e,a)=>(d(),c(Xe,{key:a},{default:p((()=>[f("div",Oa,[f("div",Va,[f("img",{src:e.url,class:"y",alt:""},null,8,ja),m(" "+O(e.t),1)]),f("div",Pa,[2===e.type&&"-"!=e.n?(d(),N("span",Ma,"¥")):Y("",!0),f("span",null,O(2===e.type?Yl(e.n):e.n),1)])])])),_:2},1024)))),128)),v(Xe,{span:24,style:{background:"#fff"}},{default:p((()=>[v(ya,{ref_key:"dataOverView",ref:i},null,512)])),_:1})])),_:1},8,["collapsed"])])),_:1}),v(n,{flex:"110px"},{default:p((()=>[v($e,{type:"primary",class:"searchBtn",style:{float:"right"},onClick:pt},{default:p((()=>[m(O(ct.value?"展开":"收起"),1)])),_:1})])),_:1})])),_:1}),v(Oe,{class:"general-card-upai",style:{width:"100%","padding-bottom":"28px"}},{default:p((()=>[v(s,{justify:"space-between"},{default:p((()=>[v(n,{flex:"250px"},{default:p((()=>[v(we,{size:18,style:{"margin-bottom":"10px"}},{default:p((()=>[v($e,{type:"primary",class:"searchBtn",onClick:Ul},{icon:p((()=>[v(ea)])),default:p((()=>[m(" 刷新数据 ")])),_:1}),v(ta,{content:"确定要关停选中计划？",onOk:Fl},{default:p((()=>[v($e,{type:"primary",class:"searchBtn"},{icon:p((()=>[v(aa)])),default:p((()=>[m(" 关停 ")])),_:1})])),_:1}),v($e,{type:"primary",class:"searchBtn",onClick:a[15]||(a[15]=e=>Sl(null))},{icon:p((()=>[v(aa)])),default:p((()=>[m(" 自动关停配置 ")])),_:1}),v($e,{type:"primary",class:"searchBtn",onClick:a[16]||(a[16]=e=>(async()=>{0!==Ht.value.length?tt.value=!0:j.info("请先选择需要添加到计划包的计划")})())},{icon:p((()=>[v(aa)])),default:p((()=>[m(" 添加到计划包 ")])),_:1}),v(ta,{content:ft.value,"popup-visible":vt.value,"ok-text":"确认删除",onPopupVisibleChange:Pt,onOk:a[17]||(a[17]=e=>Hl(null))},{default:p((()=>[v($e,{type:"primary",status:"danger"},{default:p((()=>[m("删除计划")])),_:1})])),_:1},8,["content","popup-visible"]),v($e,{type:"primary",status:"success",class:"searchBtn",onClick:a[18]||(a[18]=e=>Ml())},{icon:p((()=>[v(la)])),default:p((()=>[m(" 导出 ")])),_:1})])),_:1})])),_:1}),v(n,{flex:"60px"},{default:p((()=>[v(we,{size:18,style:{"margin-bottom":"10px"}},{default:p((()=>[v($e,{type:"primary",onClick:a[19]||(a[19]=e=>x.value=!0)},{icon:p((()=>[v(aa)])),default:p((()=>[m(" 自定义列表 ")])),_:1})])),_:1})])),_:1})])),_:1}),v(da,{displayColumns:Dt.value,"onUpdate:displayColumns":a[20]||(a[20]=e=>Dt.value=e),"row-key":"plantId","drag-sort":"col",data:At.value,"header-affixed-top":!0,"max-height":700,columns:qt.value,loading:y(ht),pagination:wt,bordered:!1,"table-layout":"fixed","on-display-columns-change":ao,onSelectChange:Dl,onSortChange:Al,onPageChange:zl},{plantNameId:p((({row:e})=>[v(we,{direction:"vertical",fill:""},{default:p((()=>[v(T,{style:{"margin-bottom":"10px"},ellipsis:{rows:1,expandable:!1}},{default:p((()=>[f("div",za,[f("span",{class:V(["ove",e.exportPlantCode==e.plantName?"":"big"])},O(e.plantName||"-"),3),e.exportPlantCode==e.plantName?(d(),N("span",Ka,[Ua,m("官方 ")])):Y("",!0)])])),_:2},1024),f("div",Aa,[m(" ID: "),v(T,{copyable:"",style:{"margin-bottom":"0"}},{default:p((()=>[m(O("0"===e.exportPlantCode?e.plantCode:e.exportPlantCode||"-"),1)])),_:2},1024)])])),_:2},1024)])),plantVideo:p((({row:e})=>[v(we,null,{default:p((()=>[v(Ce,{src:e.investedInfo.avatar||"http://lf1-xgcdn-tos.pstatp.com/obj/vcloud/vadmin/start.8e0e4855ee346a46ccff8ff3e24db27b.png",width:"40px",height:"50px",style:{width:"40px",height:"50px"}},null,8,["src"]),v(we,{direction:"vertical",fill:"",size:3},{default:p((()=>[v(T,{copyable:"",style:{"margin-bottom":"0"}},{default:p((()=>[m(O(e.investedInfo.nickName||"-"),1)])),_:2},1024),v(T,{ellipsis:{rows:1,expandable:!0}},{default:p((()=>[m(O(e.investedInfo.signature?e.investedInfo.signature:"-"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),op:p((({row:e})=>[v(we,{direction:"vertical",fill:""},{default:p((()=>[e.errorMsg?(d(),c(be,{key:0,content:e.errorMsg},{default:p((()=>[v(na,{color:ia[e.plantStatus]},{icon:p((()=>[v(oa,{style:{color:"#fff"}})])),default:p((()=>[m(" "+O(y(Ke)[e.plantStatus]||"-"),1)])),_:2},1032,["color"])])),_:2},1032,["content"])):(d(),c(na,{key:1,color:ia[e.plantStatus]},{default:p((()=>[m(O(y(Ke)[e.plantStatus]||"-"),1)])),_:2},1032,["color"])),v(we,null,{default:p((()=>[[1,4,8,101].includes(e.plantStatus)?(d(),c(ta,{key:0,type:"warning",content:"确定要关停【"+e.plantName+"】计划吗?",onOk:a=>(async e=>{try{Xl([e]).then((async a=>{const{data:t}=await Qe({plantId:e.plantId});j.success({content:"请求关停成功",duration:5e3}),Kl()})).catch((e=>{var a;const t=e.grid.map((e=>e.sphName));Kl(),null==(a=C.value)||a.showModel(t)}))}catch(a){}})(e)},{default:p((()=>[v(_e,{onClick:a=>Zt.value=e.plantId},{default:p((()=>[m("关停")])),_:2},1032,["onClick"])])),_:2},1032,["content","onOk"])):Y("",!0),10===e.plantStatus?(d(),c(_e,{key:1,status:"success",onClick:a=>Zl(e)},{default:p((()=>[m("支付")])),_:2},1032,["onClick"])):Y("",!0),v(_e,{onClick:a=>(async e=>{if(e.exportPlantCode.includes(e.plantName))return j.info("同步官方创建的计划暂不支持复投");if(!e.taskId)return j.info("暂不支持复投。");const{data:a}=await Ve({taskId:e.taskId});a.reqJson=JSON.parse(a.reqJson),a.reqJson.createTaskBefore=0,a.reqJson=JSON.stringify(a.reqJson),localStorage.setItem("createLivePlant",a.reqJson),Ft.push({name:"createlivePlant"})})(e)},{default:p((()=>[m("复投")])),_:2},1032,["onClick"]),v(_e,{onClick:a=>Ql(e)},{default:p((()=>[m("详情")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])),process:p((({row:e})=>[v(sa,{percent:Number(Yl(e.cost/e.estimatedWecoinAmount)),style:{width:"50%"}},null,8,["percent"])])),cancelPlant:p((({row:e})=>[v(we,{direction:"vertical"},{default:p((()=>[v(we,null,{default:p((()=>[v(ua,{modelValue:e.shutdownSwitch,"onUpdate:modelValue":a=>e.shutdownSwitch=a,disabled:""},null,8,["modelValue","onUpdate:modelValue"]),v(_e,{onClick:a=>Sl(e)},{icon:p((()=>[v(ra)])),_:2},1032,["onClick"])])),_:2},1024),f("span",null,O(y(Ue)[e.shutdownStatus]),1)])),_:2},1024)])),noCostTime:p((({row:e})=>[v(we,{direction:"vertical"},{default:p((()=>[f("span",null,O(e.noCostTime?$l(e.noCostTime):0),1)])),_:2},1024)])),createdCancelTime:p((({row:e})=>[v(we,{direction:"vertical"},{default:p((()=>[f("span",null,"创建："+O(e.createdAt),1),f("span",null,"关闭："+O(e.cancelTime||"-"),1)])),_:2},1024)])),startEndTime:p((({row:e})=>[v(we,{direction:"vertical"},{default:p((()=>[f("span",null,"开始："+O(e.startTime||"-"),1),f("span",null,"结束: "+O(e.endTime||"-"),1)])),_:2},1024)])),startCostTime:p((({row:e})=>[v(we,{direction:"vertical"},{default:p((()=>[f("span",null,O(e.startCostTime||"-"),1)])),_:2},1024)])),newMemberDepName:p((({row:e})=>[v(we,{direction:"vertical"},{default:p((()=>[f("span",null,O(e.newMemberDepName||"-"),1)])),_:2},1024)])),_:1},8,["displayColumns","data","columns","loading","pagination"])])),_:1})])),_:1},8,["span","xl","xxl"])])),_:1})]),v(yt,{visible:tt.value,"onUpdate:visible":a[24]||(a[24]=e=>tt.value=e),title:"添加到计划包",onCancel:a[25]||(a[25]=e=>tt.value=!1),onBeforeOk:eo},{default:p((()=>[v(We,{ref_key:"formPackageRef",ref:ot,model:lt.value,"label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:p((()=>[v(Pe,{field:"packageType",label:"选择计划包",rules:[{required:!0,message:"请选择计划包"}]},{default:p((()=>[v(pa,{modelValue:lt.value.packageType,"onUpdate:modelValue":a[21]||(a[21]=e=>lt.value.packageType=e)},{default:p((()=>[v(ca,{value:1},{default:p((()=>[m("创建新计划包")])),_:1}),v(ca,{value:2},{default:p((()=>[m("选择已有计划包")])),_:1})])),_:1},8,["modelValue"])])),_:1}),2===lt.value.packageType?(d(),c(Pe,{key:0,field:"packageId",label:"选择计划包",rules:[{required:!0,message:"请选择计划包"}]},{default:p((()=>[v(He,{modelValue:lt.value.packageId,"onUpdate:modelValue":a[22]||(a[22]=e=>lt.value.packageId=e),placeholder:"请选择计划包"},{default:p((()=>[(d(!0),N(D,null,q(nt.value,((e,a)=>(d(),c(Me,{key:a,label:e.packageName,value:e.packageId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):Y("",!0),1===lt.value.packageType?(d(),c(Pe,{key:1,field:"addName",label:"计划包名称",rules:[{required:!0,message:"请填写计划包名称"}]},{default:p((()=>[v(je,{modelValue:lt.value.addName,"onUpdate:modelValue":a[23]||(a[23]=e=>lt.value.addName=e)},null,8,["modelValue"])])),_:1})):Y("",!0)])),_:1},8,["model"])])),_:1},8,["visible"]),v(yt,{visible:Qt.value,"onUpdate:visible":a[26]||(a[26]=e=>Qt.value=e),width:"auto",footer:!1,simple:!0,"hide-cancel":"",onBeforeClose:Bl},{title:p((()=>[m(" 支付订单")])),default:p((()=>[v(Oe,{class:"general-card"},{default:p((()=>[v(we,{size:16,direction:"vertical",fill:"",style:{"text-align":"center"}},{default:p((()=>[v(Je,{value:Xt.value,size:200,level:"H",style:{position:"relative"}},null,8,["value"]),v(na,{color:"green"},{default:p((()=>[m("请用微信APP扫描二维码")])),_:1})])),_:1})])),_:1})])),_:1},8,["visible"]),v(yt,{visible:wl.value,"onUpdate:visible":a[30]||(a[30]=e=>wl.value=e),width:"700px",title:"自动关停配置",onBeforeOk:Gl},{default:p((()=>[v(We,{ref:"formJcRef","auto-label-width":"",model:xl.value},{default:p((()=>[v(Pe,{label:"已选中"},{default:p((()=>[f("span",null,"共"+O(Ht.value.length)+"条计划",1)])),_:1}),v(Pe,{label:"自动关停开启"},{default:p((()=>[v(ua,{modelValue:xl.value.shutdownStatus,"onUpdate:modelValue":a[27]||(a[27]=e=>xl.value.shutdownStatus=e)},null,8,["modelValue"])])),_:1}),v(Pe,{label:"自动关停策略"},{default:p((()=>[v(He,{modelValue:xl.value.shutdownSetId,"onUpdate:modelValue":a[28]||(a[28]=e=>xl.value.shutdownSetId=e),placeholder:"请选择自动关停策略",multiple:"",readonly:"",limit:10,onChange:Nl},{default:p((()=>[(d(!0),N(D,null,q(kl.value,((e,a)=>(d(),c(Me,{key:a,label:e.srName,value:e.srId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(Pe,{label:"新建关停策略"},{default:p((()=>[v($e,{type:"primary",onClick:a[29]||(a[29]=e=>(async(e,a)=>{2===e?(zt.value="修改关停策略",Ie.value.srId=a.srId,Ie.value.name=a.srName,Ie.value.firstType=a.firstType,Ie.value.firstVal=a.firstVal,Ie.value.flagType=a.flagType,Ie.value.secondType=a.secondType,Ie.value.secondVal=a.secondVal):(zt.value="新增关停策略",Ie.value={name:null,type:1,firstType:1,firstVal:0,secondType:1,secondVal:0,flagType:1},Ie.value.name=null,Tl()),Ie.value.type=e,Mt.value=!0})(1,null))},{icon:p((()=>[v(gt)])),default:p((()=>[m(" 创建关停策略 ")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"]),v(yt,{visible:Mt.value,"onUpdate:visible":a[37]||(a[37]=e=>Mt.value=e),title:zt.value,width:"832px",onCancel:a[38]||(a[38]=e=>Mt.value=!1),onBeforeOk:Il},{default:p((()=>[v(We,{ref_key:"formGpRef",ref:Te,model:Ie.value,"auto-label-width":!0},{default:p((()=>[v(Pe,{field:"name",label:"关停策略名称",rules:[{required:!0,message:"请填写关停策略名称"}]},{default:p((()=>[v(je,{modelValue:Ie.value.name,"onUpdate:modelValue":a[31]||(a[31]=e=>Ie.value.name=e)},null,8,["modelValue"])])),_:1}),v(Pe,{field:"name",label:"自动关停条件",rules:[{required:!0,message:"请填写关停策略名称"}]},{default:p((()=>[v(s,{gutter:8},{default:p((()=>[v(n,{span:6},{default:p((()=>[v(Pe,{field:"firstType","validate-trigger":"input",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:p((()=>[v(He,{modelValue:Ie.value.firstType,"onUpdate:modelValue":a[32]||(a[32]=e=>Ie.value.firstType=e),onChange:Tl},{default:p((()=>[(d(!0),N(D,null,q(y(ze)(y(Ae)),((e,a)=>(d(),c(Me,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),v(n,{span:4},{default:p((()=>[v(Pe,{field:"firstVal",rules:[{required:!0,message:"填写对应值"}],"no-style":""},{default:p((()=>[v(we,null,{default:p((()=>[v(je,{modelValue:Ie.value.firstVal,"onUpdate:modelValue":a[33]||(a[33]=e=>Ie.value.firstVal=e),onChange:Tl},null,8,["modelValue"]),f("span",null,O(Kt.value[Ie.value.firstType])+",",1)])),_:1})])),_:1})])),_:1}),v(n,{span:4},{default:p((()=>[v(Pe,{field:"flagType",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:p((()=>[v(He,{modelValue:Ie.value.flagType,"onUpdate:modelValue":a[34]||(a[34]=e=>Ie.value.flagType=e),onChange:Tl},{default:p((()=>[(d(!0),N(D,null,q(y(ze)(y(Ge)),((e,a)=>(d(),c(Me,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),v(n,{span:6},{default:p((()=>[v(Pe,{field:"secondType","validate-trigger":"input",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:p((()=>[v(He,{modelValue:Ie.value.secondType,"onUpdate:modelValue":a[35]||(a[35]=e=>Ie.value.secondType=e),onChange:Tl},{default:p((()=>[(d(!0),N(D,null,q(y(ze)(y(Ae)),((e,a)=>(d(),c(Me,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),v(n,{span:4},{default:p((()=>[v(Pe,{field:"secondVal",rules:[{required:!0,message:"填写对应值"}],"no-style":""},{default:p((()=>[v(we,null,{default:p((()=>[v(je,{modelValue:Ie.value.secondVal,"onUpdate:modelValue":a[36]||(a[36]=e=>Ie.value.secondVal=e),onChange:Tl},null,8,["modelValue"]),f("span",null,O(Kt.value[Ie.value.secondType]),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(Pe,null,{default:p((()=>[v(Le,{type:"secondary"},{default:p((()=>[m(" 提示："),Ga,m(" “并且” 代表两个条件同时满足才触发自动关停 "),Ha,m(" “或者” 代表两个条件只需满足其中一个就会触发自动 ")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"]),v(al,{width:980,visible:tl.value,"mask-closable":"",footer:!1,header:!1,onCancel:a[42]||(a[42]=e=>tl.value=!1)},{title:p((()=>[])),default:p((()=>[v(u,{loading:ll.value},{default:p((()=>[Gt.value?(d(),N("div",Ba,[v(De,{style:{"margin-top":"10px","padding-left":"10px"}},{title:p((()=>[f("span",null," 计划名称: "+O(Gt.value.plantName),1)])),default:p((()=>[v(Ne,{label:"ID"},{default:p((()=>[m(O(Gt.value.exportPlantCode),1)])),_:1}),v(Ne,{label:"投放金额"},{default:p((()=>[m("¥"+O(Gt.value.estimatedWecoinAmount/10),1)])),_:1}),v(Ne,{label:"数据更新时间"},{default:p((()=>[m(O(Gt.value.updatedAt),1)])),_:1})])),_:1}),v(_t,{style:{margin:"0"}}),v(Lt,{"default-active-key":"1",style:{"margin-top":"10px",width:"940px"},size:"large"},{default:p((()=>[v(Tt,{key:"1",title:"计划详情",style:{"padding-left":"10px"}},{default:p((()=>[v(we,null,{default:p((()=>[v(Ce,{src:Gt.value.investedInfo.avatar||"http://lf1-xgcdn-tos.pstatp.com/obj/vcloud/vadmin/start.8e0e4855ee346a46ccff8ff3e24db27b.png",width:"80px",height:"100px",style:{width:"80px",height:"100px"}},null,8,["src"]),v(we,{direction:"vertical",fill:""},{default:p((()=>[v(T,null,{default:p((()=>[m(O(Gt.value.investedInfo.signature),1)])),_:1}),v(T,null,{default:p((()=>[m(O(Gt.value.goodsInfo?Gt.value.goodsInfo.goodsName:"-"),1)])),_:1})])),_:1}),v(we,null,{default:p((()=>[v(sa,{type:"circle",percent:Number(Yl(Gt.value.cost/Gt.value.estimatedWecoinAmount))},null,8,["percent"]),v(na,{status:"success"},{default:p((()=>[m(O(y(Ke)[Gt.value.plantStatus]),1)])),_:1})])),_:1})])),_:1}),v(s,{gutter:[55,0]},{default:p((()=>[v(n,{flex:1},{default:p((()=>[f("div",Fa,[Ea,v(s,{gutter:[10,10]},{default:p((()=>[(d(!0),N(D,null,q(vl.value,((e,a)=>(d(),c(n,{key:a,span:5},{default:p((()=>[f("div",Ra,[f("div",$a,[f("img",{src:e.url,class:"y",alt:""},null,8,Ja),m(" "+O(e.t)+" ",1),e.tips?(d(),c(be,{key:0},{content:p((()=>[f("p",null,O(e.tips),1),f("p",null,O(e.tips2),1)])),default:p((()=>[v(bt)])),_:2},1024)):Y("",!0)]),f("div",La,[2===e.type&&"-"!=e.n?(d(),N("span",Wa,"¥")):Y("",!0),f("span",null,O(2===e.type?Yl(e.n):e.n),1)])])])),_:2},1024)))),128))])),_:1})])])),_:1})])),_:1}),v(s,{gutter:[55,0]},{default:p((()=>[v(n,{flex:1},{default:p((()=>[f("div",Qa,[Xa,v(De,{style:{"margin-top":"10px","padding-left":"10px"},column:2,data:ml.value},{title:p((()=>[])),default:p((()=>[(d(!0),N(D,null,q(ml.value,((e,a)=>(d(),c(Ne,{key:a,label:e.label},{default:p((()=>[v(T,{style:{"max-width":"250px"},ellipsis:{rows:1,expandable:e.expandable,showTooltip:!0}},{default:p((()=>[m(O(e.value?e.value:"-"),1)])),_:2},1032,["ellipsis"])])),_:2},1032,["label"])))),128))])),_:1},8,["data"])])])),_:1})])),_:1}),v(s,{gutter:[55,0]},{default:p((()=>[v(n,{flex:1},{default:p((()=>[f("div",Za,[et,v(De,{style:{"margin-top":"10px","padding-left":"10px"},column:2,data:fl.value},{title:p((()=>[])),default:p((()=>[(d(!0),N(D,null,q(fl.value,((e,a)=>(d(),c(Ne,{key:a,label:e.label},{label:p((()=>[v(we,null,{default:p((()=>[m(O(e.label)+" ",1),""!==e.key?(d(),c(be,{key:0},{content:p((()=>[f("p",null,O(e.tips),1)])),default:p((()=>[v(bt)])),_:2},1024)):Y("",!0)])),_:2},1024)])),default:p((()=>[v(T,{style:{"max-width":"250px"},ellipsis:{rows:1,expandable:e.expandable}},{default:p((()=>[m(O(e.value?e.value:"-"),1)])),_:2},1032,["ellipsis"])])),_:2},1032,["label"])))),128))])),_:1},8,["data"])])])),_:1})])),_:1}),v(s,{justify:"end"},{default:p((()=>[v(n,{flex:"60px"},{default:p((()=>[v(ta,{content:ft.value,"popup-visible":mt.value,"ok-text":"确认删除",onPopupVisibleChange:jt,onOk:a[39]||(a[39]=e=>Hl(Gt.value.plantId))},{default:p((()=>[v($e,{type:"primary",status:"danger"},{default:p((()=>[m("删除计划")])),_:1})])),_:1},8,["content","popup-visible"])])),_:1})])),_:1})])),_:1}),v(Tt,{key:"2",title:"计划日志",style:{"padding-left":"10px"}},{default:p((()=>[v(Rt,{pagination:!0,hoverable:!0,stripe:!1,loading:gl.value,data:yl.value,bordered:!1},{columns:p((()=>[v(Bt,{title:"操作时间",align:"center"},{cell:p((({record:e})=>[m(O(e.createdAt),1)])),_:1}),v(Bt,{title:"行为",align:"center"},{cell:p((({record:e})=>[m(O(e.plantLog),1)])),_:1}),v(Bt,{title:"操作人",align:"center"},{cell:p((({record:e})=>[m(O(-2==e.createUser?"个人/系统":0==e.createUser?"系统":"管理员"),1)])),_:1})])),_:1},8,["loading","data"])])),_:1}),v(Tt,{key:"3",title:"阶段数据",style:{"padding-left":"10px"}},{default:p((()=>[v(Jt,{style:{height:"800px",overflow:"auto"}},{default:p((()=>[v(Rt,{pagination:!1,hoverable:!0,stripe:!1,loading:xt.value,data:kt.value,scroll:dt,bordered:!1},{columns:p((()=>[v(Bt,{title:"时间",align:"center",width:220},{cell:p((({record:e})=>[m(O(e.createdAt),1)])),_:1}),v(Bt,{title:"消耗金额",align:"center","data—index":"cost",width:240},{default:p((()=>[v(Bt,{title:ga.value,align:"center","data—index":"cost",width:240},{cell:p((({record:e})=>[m(O(e.cost),1)])),_:1},8,["title"])])),_:1}),v(Bt,{title:"阶段消耗",align:"center"},{cell:p((({record:e})=>[m(O(e.stageCost),1)])),_:1}),v(Bt,{title:"阶段订单",align:"center"},{cell:p((({record:e})=>[m(O(e.stageOrderCount),1)])),_:1}),v(Bt,{title:"阶段GMV",align:"center"},{cell:p((({record:e})=>[m(O(e.stageGmv),1)])),_:1}),v(Bt,{title:"阶段点击",align:"center"},{cell:p((({record:e})=>[m(O(e.stageClick),1)])),_:1}),v(Bt,{title:"阶段评论",align:"center"},{cell:p((({record:e})=>[m(O(e.stageFavCount||"-"),1)])),_:1}),v(Bt,{title:"阶段关注",align:"center"},{cell:p((({record:e})=>[m(O(e.stageFollowCount||"-"),1)])),_:1}),v(Bt,{title:"阶段浏览",align:"center"},{cell:p((({record:e})=>[m(O(e.stageFollowCount||"-"),1)])),_:1}),v(Bt,{title:"点击成本",align:"center"},{cell:p((({record:e})=>[m(O(Ol(e.stageCost/e.stageClick)),1)])),_:1}),v(Bt,{title:"成交ROI",align:"center"},{cell:p((({record:e})=>[m(O(Ol(e.productPlaceorderGmv/e.cost)),1)])),_:1}),v(Bt,{title:"佣金ROI",align:"center"},{cell:p((({record:e})=>[m(O(Ol(e.productPlaceorderGmv*(e.yjl/100)/e.cost)),1)])),_:1})])),_:1},8,["loading","data"]),f("div",at,[f("div",null,[v($t,{current:Ct.pageIndex,"onUpdate:current":a[40]||(a[40]=e=>Ct.pageIndex=e),"page-size":Ct.pageSize,"onUpdate:pageSize":a[41]||(a[41]=e=>Ct.pageSize=e),total:Ct.total,"show-total":!0,"show-page-size":!0,onChange:Rl},null,8,["current","page-size","total"])])])])),_:1})])),_:1})])),_:1})])):Y("",!0)])),_:1},8,["loading"])])),_:1},8,["visible"]),v(l,{ref_key:"loginSphModal",ref:C},null,512),v(o,{"custom-columns-visable":x.value,"onUpdate:customColumnsVisable":a[43]||(a[43]=e=>x.value=e),"display-columns":Dt.value,"onUpdate:displayColumns":a[44]||(a[44]=e=>Dt.value=e),"admange-columns-ref":qt.value,"onUpdate:admangeColumnsRef":a[45]||(a[45]=e=>qt.value=e),columns:qt.value,"sys-default-columns":y(va),"find-key-name-columns":Yt.value,"render-columns":Ot.value,group:Nt.value,"default-columns":St.value,onUpdateColumns:Vt},null,8,["custom-columns-visable","display-columns","admange-columns-ref","columns","sys-default-columns","find-key-name-columns","render-columns","group","default-columns"])])}}}),[["__scopeId","data-v-76093f2a"]]);export{tt as default};
