import{_ as e}from"./index.a302575e.js";/* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css              *//* empty css               */import{d as a,f as l,r as t,aH as s,D as n,E as u,H as d,aK as i,aJ as o,aO as r,u as p,aP as f,aM as c,aL as m,b_ as v,bk as g,bu as y,bv as _,c2 as b,bl as x,by as V,bG as T,bq as h,c3 as j,bz as w,c8 as z,c4 as C,c6 as k,c7 as I,c9 as S,be as U,b9 as q,ba as D,aF as Y,cd as M}from"./arco.0e1801a1.js";import{u as B}from"./loading.4d3258a0.js";import{s as N,a as P,b as A}from"./rule.9a62b1db.js";import{r as E,c as G,e as H}from"./enum.5f967a9b.js";import{f as L}from"./vue.6618b53d.js";import"./chart.b4fe0742.js";const O=e=>(q("data-v-9101b7cb"),e=e(),D(),e),F={class:"container"},J={class:"upai_content"},K=O((()=>d("div",{class:"pageTitle"}," 自动关停策略 ",-1))),R=O((()=>d("div",{class:"labelText"},"名称搜索：",-1))),Q={class:"pagination"},W=O((()=>d("br",null,null,-1))),X=O((()=>d("br",null,null,-1))),Z=e(a({__name:"grid",setup(e,{expose:a}){const{loading:q,setLoading:D}=B(!0),O=l(!1),Z=l("新建计划包"),$=l(["","元","元","元","小时","","","小时"]),ee=l({name:null,type:1,firstType:1,firstVal:0,secondType:1,secondVal:0,flagType:1,srType:2}),ae=l(),le={current:1,pageIndex:1,pageSize:10},te=t({...le}),se=()=>({startDate:v().add(-1,"month").format("YYYY-MM-DD").toString(),endDate:v().format("YYYY-MM-DD").toString(),name:"",pageIndex:1,pageSize:10,srType:2}),ne=l(se()),ue=l([]),de=async e=>{D(!0);try{const{data:a}=await N(e);ue.value=a.grid,te.current=e.pageIndex,te.pageIndex=e.pageIndex,te.total=a.total}catch(a){}finally{D(!1)}},ie=e=>{le.pageIndex=e,le.current=e,te.pageIndex=e,te.current=e,de({...ne.value,...le})},oe=e=>{le.pageSize=e,te.pageSize=e,de({...ne.value,...le})},re=()=>{ie(1)},pe=async e=>{var a;await(null==(a=ae.value)?void 0:a.validate())?e(!1):(1===ee.value.type?(await P({...ee.value}),g.success({content:"添加关停策略成功",duration:5e3}),await re()):(await A({...ee.value}),g.success({content:"修改关停策略成功",duration:5e3}),await re()),ee.value.name=null,window.setTimeout((()=>{e()}),300))};L();const fe=()=>{ee.value.name=E[ee.value.firstType]+ee.value.firstVal+G[ee.value.flagType]+E[ee.value.secondType]+ee.value.secondVal},ce=async(e,a)=>{2===e?(Z.value="修改关停策略",ee.value.srId=a.srId,ee.value.name=a.srName,ee.value.firstType=a.firstType,ee.value.firstVal=a.firstVal,ee.value.flagType=a.flagType,ee.value.secondType=a.secondType,ee.value.secondVal=a.secondVal,ee.value.srType=2):(Z.value="新增关停策略",ee.value={name:null,type:1,firstType:1,firstVal:0,secondType:1,secondVal:0,flagType:1,srType:2},ee.value.name=null,ee.value.srType=2,fe()),ee.value.type=e,O.value=!0};return de({...ne.value}),a({fetchData:de}),(e,a)=>{const l=s("Breadcrumb"),t=y,v=_,g=b,D=x,B=V,N=T,P=h,A=j,L=w,le=z,de=s("icon-plus"),me=C,ve=k,ge=I,ye=M,_e=S,be=U;return n(),u("div",F,[d("div",J,[i(l,{items:["直播投流管理","自动关停策略"]}),K,i(A,null,{default:o((()=>[i(le,{class:"general-card-upai",style:{width:"100%"}},{default:o((()=>[i(A,null,{default:o((()=>[i(g,{flex:1},{default:o((()=>[i(L,{model:ne.value,"auto-label-width":"","label-align":"left"},{default:o((()=>[i(A,{gutter:16},{default:o((()=>[i(g,{span:8},{default:o((()=>[i(v,{field:"sphName"},{label:o((()=>[R])),default:o((()=>[i(t,{modelValue:ne.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>ne.value.name=e),placeholder:"请输入关停策略名称","allow-clear":"",onPressEnter:re},null,8,["modelValue"])])),_:1})])),_:1}),i(g,{span:8},{default:o((()=>[i(v,{field:"number","hide-label":!0},{default:o((()=>[i(P,{size:18},{default:o((()=>[i(D,{type:"primary",class:"searchBtn",onClick:re},{default:o((()=>[r(" 筛选 ")])),_:1}),i(D,{type:"outline",class:"refreshBtn",onClick:a[1]||(a[1]=e=>re())},{default:o((()=>[r(" 刷新 ")])),_:1}),i(N,{type:"primary"},{default:o((()=>[i(B,{href:"javascript:void(0)",onClick:a[2]||(a[2]=e=>{ne.value=se()})},{default:o((()=>[r("重置筛选条件")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1})])),_:1}),i(le,{class:"general-card-upai",style:{width:"100%","padding-bottom":"28px"}},{default:o((()=>[i(A,{style:{"margin-bottom":"16px"}},{default:o((()=>[i(g,{span:16},{default:o((()=>[i(P,null,{default:o((()=>[i(D,{type:"primary",onClick:a[3]||(a[3]=e=>ce(1,null))},{icon:o((()=>[i(de)])),default:o((()=>[r(" 创建关停策略 ")])),_:1})])),_:1})])),_:1})])),_:1}),i(A,null,{default:o((()=>[i(g,{flex:"1"},{default:o((()=>[i(ve,{"row-key":"id",pagination:!1,hoverable:!0,loading:p(q),stripe:!1,data:ue.value,bordered:!1},{columns:o((()=>[i(me,{title:"关停策略名称","data-index":"srName",align:"center"}),i(me,{title:"关停策略","data-index":"",align:"center"},{cell:o((({record:e})=>[r(f(p(E)[e.firstType]+e.firstVal+p(G)[e.flagType]+p(E)[e.secondType]+e.secondVal),1)])),_:1}),i(me,{title:"更新时间","data-index":"updatedAt",align:"center"}),i(me,{title:"创建时间","data-index":"createdAt",align:"center"}),i(me,{align:"center",fixed:"right",title:"操作","data-index":"operations"},{cell:o((({record:e})=>[i(D,{type:"text",size:"small",onClick:a=>ce(2,e)},{default:o((()=>[r(" 修改 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data"]),d("div",Q,[d("div",null,[i(ge,{current:te.pageIndex,"onUpdate:current":a[4]||(a[4]=e=>te.pageIndex=e),"page-size":te.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>te.pageSize=e),total:te.total,"show-total":!0,"show-page-size":!0,"page-size-options":[10,20,50,100,200],onChange:ie,onPageSizeChange:oe},null,8,["current","page-size","total"])])])])),_:1})])),_:1})])),_:1})]),i(be,{visible:O.value,"onUpdate:visible":a[12]||(a[12]=e=>O.value=e),title:Z.value,width:"840px",onCancel:a[13]||(a[13]=e=>O.value=!1),onBeforeOk:pe},{default:o((()=>[i(L,{ref_key:"formGpRef",ref:ae,model:ee.value,"auto-label-width":!0},{default:o((()=>[i(v,{field:"name",label:"关停策略名称",rules:[{required:!0,message:"请填写关停策略名称"}]},{default:o((()=>[i(t,{modelValue:ee.value.name,"onUpdate:modelValue":a[6]||(a[6]=e=>ee.value.name=e)},null,8,["modelValue"])])),_:1}),i(v,{field:"name",label:"自动关停条件",rules:[{required:!0,message:"请填写关停策略名称"}]},{default:o((()=>[i(A,{gutter:8},{default:o((()=>[i(g,{span:6},{default:o((()=>[i(v,{field:"firstType","validate-trigger":"input",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:o((()=>[i(_e,{modelValue:ee.value.firstType,"onUpdate:modelValue":a[7]||(a[7]=e=>ee.value.firstType=e),onChange:fe},{default:o((()=>[(n(!0),u(c,null,m(p(H)(p(E)),((e,a)=>(n(),Y(ye,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(g,{span:4},{default:o((()=>[i(v,{field:"firstVal",rules:[{required:!0,message:"填写对应值"}],"no-style":""},{default:o((()=>[i(P,null,{default:o((()=>[i(t,{modelValue:ee.value.firstVal,"onUpdate:modelValue":a[8]||(a[8]=e=>ee.value.firstVal=e),onChange:fe},null,8,["modelValue"]),d("span",null,f($.value[ee.value.firstType])+",",1)])),_:1})])),_:1})])),_:1}),i(g,{span:4},{default:o((()=>[i(v,{field:"flagType",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:o((()=>[i(_e,{modelValue:ee.value.flagType,"onUpdate:modelValue":a[9]||(a[9]=e=>ee.value.flagType=e),onChange:fe},{default:o((()=>[(n(!0),u(c,null,m(p(H)(p(G)),((e,a)=>(n(),Y(ye,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(g,{span:6},{default:o((()=>[i(v,{field:"secondType","validate-trigger":"input",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:o((()=>[i(_e,{modelValue:ee.value.secondType,"onUpdate:modelValue":a[10]||(a[10]=e=>ee.value.secondType=e),onChange:fe},{default:o((()=>[(n(!0),u(c,null,m(p(H)(p(E)),((e,a)=>(n(),Y(ye,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(g,{span:4},{default:o((()=>[i(v,{field:"secondVal",rules:[{required:!0,message:"填写对应值"}],"no-style":""},{default:o((()=>[i(P,null,{default:o((()=>[i(t,{modelValue:ee.value.secondVal,"onUpdate:modelValue":a[11]||(a[11]=e=>ee.value.secondVal=e),onChange:fe},null,8,["modelValue"]),d("span",null,f($.value[ee.value.secondType]),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),i(v,null,{default:o((()=>[i(N,{type:"secondary"},{default:o((()=>[r(" 提示："),W,r(" “并且” 代表两个条件同时满足才触发自动关停 "),X,r(" “或者” 代表两个条件只需满足其中一个就会触发自动 ")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-9101b7cb"]]);export{Z as default};
