import{u as e,v as a,_ as l}from"./index.a302575e.js";/* empty css              *//* empty css               *//* empty css                */import{d as t,r as o,f as s,w as i,aU as u,aH as r,D as d,E as n,aK as c,aJ as v,aO as p,H as m,aP as f,u as g,aG as y,bk as h,bl as _,bq as b,c2 as x,c3 as S,bU as I,c4 as w,c5 as k,c6 as z,c7 as C,c8 as j,be as V,b9 as P,ba as U,b_ as R,o as T,aM as L,aL as A,aF as N,bK as q,bR as M,c9 as K,bv as Y,bi as B,ca as H,bz as O,cb as D,cc as G,bS as W,cd as E,F,bu as J}from"./arco.0e1801a1.js";import{s as $,g as Q,a as X,b as Z}from"./merchantApi.2fad71a7.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                */import{s as ee,g as ae,a as le}from"./sph-aide.33599de6.js";import{Q as te}from"./qrcode.vue.esm.973da956.js";import{f as oe}from"./vue.6618b53d.js";/* empty css                *//* empty css               *//* empty css               */import{u as se}from"./loading.4d3258a0.js";import{s as ie,i as ue}from"./enum.5f967a9b.js";import"./chart.b4fe0742.js";const re=e=>(P("data-v-f65dc456"),e=e(),U(),e),de={class:""},ne=["src"],ce={class:"pagination"},ve=re((()=>m("div",null,null,-1))),pe={key:0,class:"mark"},me={class:"iconBox"},fe=re((()=>m("span",{style:{"font-size":"16px",color:"#1d2129","font-weight":"bold",display:"block"}}," 扫码成功 ",-1))),ge=l(t({__name:"list-aide",props:{productId:{type:Number}},setup(l){e();const t=l;oe(),o({sphId:void 0,days:1,syncType:1});const P=s(!1);s(!1),s(!1);const U=s(!1);s("");const R=s(""),T=s(""),L=s(!1);s(),s(0),s(0);const A=s("修改信息"),N=["","#00b42a","#f53f3f"],q=s(0);i((()=>t.productId),(e=>{q.value=e}));const M=s({sphId:void 0,sphType:0,sphRemark:"",type:1});s({sphRemark:"备注名称"});const{loading:K,setLoading:Y}=se(!0);a.exports.useI18n();const B=s([]),H=s({});s(!1),s("");const O={current:1,pageIndex:1,pageSize:10},D=o({...O}),G=async e=>{Y(!0);try{const{data:a}=await ee(e);B.value=a.grid,B.value.forEach((e=>{e.addWindowLoading=!1})),D.current=e.pageIndex,D.pageIndex=e.pageIndex,D.total=a.total}catch(a){}finally{Y(!1)}},W=e=>{O.pageIndex=e,O.current=e,D.pageIndex=e,D.current=e,G({...H.value,...O})},E=e=>{O.pageSize=e,D.pageSize=e,G({...H.value,...O})},F=()=>{W(1)};G({...H.value,...O});const J=s(!1),Q=s(null),X=async()=>{if(J.value)return;J.value=!0;const e=await le({token:T.value});if(J.value=!1,5===e.data.status&&(L.value=!0),1===e.data.status)return h.success({content:"登录成功",duration:5e3}),U.value=!1,L.value=!1,F(),clearInterval(Q.value),void(Q.value=null);Q.value=setTimeout(X,1e3)},Z=async(e,a,l)=>{if(2===e)A.value="修改视频号信息",M.value=a,M.value.type=2,P.value=!0;else{P.value=!1;const{data:e}=await ae({},l);R.value=e.url,T.value=e.token,U.value=!0,Q.value=setTimeout(X,1e3)}};u((()=>{clearInterval(Q.value),Q.value=null})),s();return(e,a)=>{const l=_,t=b,o=x,s=S,i=I,u=w,P=k,T=z,A=C,M=r("icon-check-circle-fill"),Y=j,H=V;return d(),n("div",de,[c(s,{style:{"margin-bottom":"16px"}},{default:v((()=>[c(o,{span:16},{default:v((()=>[c(t,null,{default:v((()=>[c(l,{type:"primary",onClick:a[0]||(a[0]=e=>Z(1,{},!0))},{default:v((()=>[p(" 登录投放号助手 ")])),_:1})])),_:1})])),_:1})])),_:1}),c(T,{"row-key":"id",pagination:!1,loading:g(K),data:B.value,hoverable:!0,stripe:!1,"sticky-header":!0,bordered:!1,onPageChange:W},{columns:v((()=>[c(u,{title:"账号信息"},{cell:v((({record:e})=>[c(t,null,{default:v((()=>[c(i,null,{default:v((()=>[m("img",{alt:"avatar",src:e.sphAvatar},null,8,ne)])),_:2},1024),p(" "+f(e.sphName),1)])),_:2},1024)])),_:1}),c(u,{title:"在线状态",align:"center",width:120},{cell:v((({record:e})=>[c(P,{color:N[e.sphStatus]},{default:v((()=>[p(f(g(ie)[e.sphStatus]),1)])),_:2},1032,["color"])])),_:1}),c(u,{title:"添加权限",align:"center"},{cell:v((({record:e})=>[p(f(g(ue)[e.isWindows]),1)])),_:1}),c(u,{align:"center",title:"操作","data-index":"operations",fixed:"right",width:250},{cell:v((({record:e})=>[c(t,{direction:"vertical"},{default:v((()=>[c(t,null,{default:v((()=>[c(l,{loading:e.addWindowLoading,type:"primary",size:"small",onClick:a=>(async e=>{if(1!==e.sphStatus)return h.info("当前账号已离线，请重新登录"),void Z(1,{},!0);e.addWindowLoading=!0;try{const{data:a,code:l}=await $({sphAideId:e.sphId,productId:q.value});200===l&&(h.success("添加成功"),F()),11020===l&&(h.info("当前账号已离线，请重新登录"),Z(1,{},!0))}catch(a){}finally{e.addWindowLoading=!1}})(e)},{default:v((()=>[p(" 添加 ")])),_:2},1032,["loading","onClick"])])),_:2},1024)])),_:2},1024)])),_:1})])),_:1},8,["loading","data"]),m("div",ce,[ve,m("div",null,[c(A,{current:D.pageIndex,"onUpdate:current":a[1]||(a[1]=e=>D.pageIndex=e),"page-size":D.pageSize,"onUpdate:pageSize":a[2]||(a[2]=e=>D.pageSize=e),total:Number(D.total)||0,"show-total":!0,"show-page-size":!0,"page-size-options":[10,20,50,100,200],onChange:W,onPageSizeChange:E},null,8,["current","page-size","total"])])]),c(H,{visible:U.value,"onUpdate:visible":a[3]||(a[3]=e=>U.value=e),width:"auto",footer:!1,simple:!0,"hide-cancel":""},{title:v((()=>[p(" 添加视频号助手账号")])),default:v((()=>[c(Y,{class:"general-card"},{default:v((()=>[c(t,{size:16,direction:"vertical",fill:""},{default:v((()=>[c(t,{direction:"vertical",fill:"",style:{"text-align":"center",position:"relative"}},{default:v((()=>[c(te,{value:R.value,size:200,level:"H",style:{position:"relative"}},null,8,["value"]),L.value?(d(),n("div",pe,[m("div",me,[c(M,{style:{color:"rgb(0, 180, 42)"}}),fe])])):y("",!0),c(P,{color:"green"},{default:v((()=>[p("请用微信APP扫描二维码")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["visible"])])}}}),[["__scopeId","data-v-f65dc456"]]),ye=e=>(P("data-v-90ad20e5"),e=e(),U(),e),he={class:"list"},_e={class:"img"},be=["src"],xe={class:"demo-arrow"},Se=ye((()=>m("div",{class:"name"},"扫码预览商品详情",-1))),Ie={class:"title"},we={class:"money"},ke={class:"pagination"},ze=ye((()=>m("p",null,"需要前往魔力PC视频号管理-登录视频号助手账号",-1))),Ce=l(t({__name:"list",props:{formModel:{type:[Object]}},setup(e,{expose:a}){s(!0);const l=s({current:1,pageIndex:1,pageSize:12,total:0}),t=s(),o=s([]),u=e,x=s(!1);s([]),s(""),s(!1);const S=s(R(R().add(1,"day").format("YYYY-MM-DD")).valueOf()+9999),I=[{label:"永久",value:Number(S.value)}],w=s(!1),k=s(!1),z=s(0),P=oe(),U=s([]),F=s({id:0,ratio:void 0,sphAideId:void 0,endTime:0});s("永久");const J=e=>{e===S.value?F.value.endTime=0:F.value.endTime=e/1e3};i(u.formModel,((e,a)=>{$()})),T((()=>{$()}));const $=async()=>{x.value=!0;try{const e={...u.formModel,pageIndex:l.value.pageIndex,pageSize:l.value.pageSize},{data:a}=await Q(e),t=a?a.grid:"";t&&t.length?(o.value=t,l.value.total=a.total):(o.value=[],l.value.total=0)}catch(e){}x.value=!1},Z=e=>{$()},ae=e=>{l.value.pageIndex=1,l.value.pageSize=e,o.value=[],$()},le=async e=>{const{data:a}=await ee({pageIndex:1,pageSize:100,sphName:e});U.value=a.grid};le(null);const se=s(),ie=async e=>{var a;await(null==(a=se.value)?void 0:a.validate())?e(!1):(await X(F.value),h.success({content:"申请成功",duration:5e3}),window.setTimeout((()=>{e()}),300))};return a({getGoodsGridList:$}),(e,a)=>{const s=_,i=D,u=j,h=G,T=q,$=C,Q=V,X=r("icon-question-circle-fill"),ee=M,oe=b,ue=W,re=E,de=K,ne=Y,ce=B,ve=H,pe=O;return d(),n("div",null,[c(T,{loading:x.value,style:{width:"100%"}},{default:v((()=>[m("div",he,[(d(!0),n(L,null,A(o.value,((e,a)=>(d(),N(u,{class:"li",hoverable:""},{default:v((()=>[m("div",_e,[m("img",{src:e.productHeadImg},null,8,be),c(s,{class:"leftButton",type:"outline",onClick:a=>(e=>{k.value=!0,z.value=e.productId,F.value.id=e.id,F.value.ratio="",F.value.sphAideId="",F.value.endTime=0,F.value.pickerTimer="",F.value.select=""})(e)},{default:v((()=>[p("申请定向推广")])),_:2},1032,["onClick"]),c(i,{trigger:"click","show-arrow":"",onShow:a=>(async e=>{t.value=`https://liteapp.weixin.qq.com/q/ABMNbs?shopId=${e}`})(e.productId)},{content:v((()=>[m("div",xe,[c(te,{value:t.value,size:160,level:"H",style:{position:"relative"}},null,8,["value"]),Se])])),default:v((()=>[c(s,{class:"rightButton",type:"outline"},{default:v((()=>[p(" 详情 ")])),_:1})])),_:2},1032,["onShow"])]),m("div",Ie,f(e.productName),1),m("div",we,[p(" ￥ "+f(e.productPrice/100)+" ",1),m("span",null,"佣金"+f(e.ratio)+"%",1)]),c(s,{type:"primary",class:"button",onClick:a=>(e=>{w.value=!0,z.value=e.productId})(e)},{default:v((()=>[p("添加到橱窗")])),_:2},1032,["onClick"])])),_:2},1024)))),256)),0===o.value.length?(d(),N(h,{key:0,class:"emptylist"})):y("",!0)])])),_:1},8,["loading"]),m("div",ke,[m("div",null,[c($,{current:l.value.pageIndex,"onUpdate:current":a[0]||(a[0]=e=>l.value.pageIndex=e),"page-size":l.value.pageSize,"onUpdate:pageSize":a[1]||(a[1]=e=>l.value.pageSize=e),total:Number(l.value.total),"show-total":!0,"show-page-size":!0,"page-size-options":[12,20,50,100,200],onChange:Z,onPageSizeChange:ae},null,8,["current","page-size","total"])])]),c(Q,{visible:w.value,"onUpdate:visible":a[2]||(a[2]=e=>w.value=e),title:"添加商品至橱窗",width:950,"mask-closable":!1,"hide-cancel":!0,"ok-text":"关闭"},{default:v((()=>[c(ge,{"product-id":z.value},null,8,["product-id"])])),_:1},8,["visible"]),c(Q,{visible:k.value,"onUpdate:visible":a[8]||(a[8]=e=>k.value=e),title:"申请定向推广",width:650,"mask-closable":!1,onBeforeOk:ie},{default:v((()=>[c(pe,{ref_key:"formJcRef",ref:se,model:F.value,"auto-label-width":"",style:{width:"420px"}},{default:v((()=>[c(ne,{field:"sphAideId",label:"发布号",rules:[{required:!0,message:"请选择发布号"}],"validate-trigger":["change","input"]},{label:v((()=>[c(oe,{size:3},{default:v((()=>[p(" 视频号 "),c(ee,{title:""},{content:v((()=>[ze])),default:v((()=>[c(X)])),_:1})])),_:1})])),default:v((()=>[c(de,{"model-value":F.value.sphAideId,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value.sphAideId=e),"input-value":F.value.select,"onUpdate:inputValue":a[4]||(a[4]=e=>F.value.select=e),placeholder:"可输入视频号名称或备注名进行搜索","allow-search":{retainInputValue:!0},"allow-clear":"",style:{"margin-right":"10px"},onSearch:le},{default:v((()=>[(d(!0),n(L,null,A(U.value,((a,l)=>(d(),N(re,{key:l,label:a.sphName,value:a.sphId,onClick:l=>e.clickSphAide(a)},{default:v((()=>[c(ue,{color:1===a.sphStatus?"green":"red"},null,8,["color"]),p(" "+f(a.sphName),1)])),_:2},1032,["label","value","onClick"])))),128))])),_:1},8,["model-value","input-value"]),c(s,{type:"primary",size:"small",onClick:a[5]||(a[5]=e=>{P.push({name:"sphList",query:{key:2}})})},{default:v((()=>[p(" 登录视频号 ")])),_:1})])),_:1}),c(ne,{field:"ratio",label:"申请佣金率",rules:[{required:!0,message:"请填写申请佣金率"}],"validate-trigger":["change","input"]},{label:v((()=>[p(" 申请佣金率 ")])),default:v((()=>[c(ce,{modelValue:F.value.ratio,"onUpdate:modelValue":a[6]||(a[6]=e=>F.value.ratio=e),placeholder:"请填写申请佣金率",min:0,max:90},null,8,["modelValue"])])),_:1}),c(ne,{field:"pickerTimer",label:"推广结束时间",rules:[{required:!0,message:"请填写推广结束时间"}],"validate-trigger":["change","input"]},{label:v((()=>[p(" 推广结束时间 ")])),default:v((()=>[c(ve,{modelValue:F.value.pickerTimer,"onUpdate:modelValue":a[7]||(a[7]=e=>F.value.pickerTimer=e),class:"datePicker","show-time":"","shortcuts-position":"left",shortcuts:I,"value-format":"timestamp","preview-shortcut":!1,"popup-container":"body","disabled-date":e=>g(R)(e).isBefore(g(R)()),format:e=>`${g(R)(e).valueOf()===S.value?"永久":g(R)(e).format("YYYY-MM-DD HH:mm:ss")}`,onChange:J},null,8,["modelValue","disabled-date","format"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])])}}}),[["__scopeId","data-v-90ad20e5"]]),je=e=>(P("data-v-980b0011"),e=e(),U(),e),Ve={class:"container"},Pe={class:"box_bcw",style:{width:"100%"}},Ue=je((()=>m("span",{class:"rowText"},"商品类目:",-1))),Re={class:"tagOverflow"},Te=je((()=>m("span",{class:"rowText"},"筛选:",-1))),Le=je((()=>m("span",{class:"fl-right"},"元",-1))),Ae=je((()=>m("span",{class:"line"},null,-1))),Ne=je((()=>m("span",{class:"fl-right"},"元",-1))),qe=je((()=>m("span",{class:"fl-right"},"%",-1))),Me=je((()=>m("span",{class:"line"},null,-1))),Ke=je((()=>m("span",{class:"fl-right"},"%",-1))),Ye=je((()=>m("span",{class:"rowText"},"排序:",-1))),Be={class:"sortIcon"},He={class:"sortIcon"},Oe=l(t({__name:"index",setup(e){const a=s({productId:"",productName:"",catId:"",catLevel:"",minPrice:"",maxPrice:"",minRatio:"",maxRatio:"",orderKey:"",orderSort:""}),l=s([]),t=s(!0),o=s({salesSort:0,moneySort:0,startSort:0}),i=s();T((()=>{b()}));const u=(e,l)=>{"0"===l&&(0==e?a.value.minPrice=1:1==e?a.value.maxPrice=1:2==e?a.value.minRatio=1:3==e&&(a.value.maxRatio=1))},g=(e,l)=>{a.value.catId=e,a.value.catLevel=l},h=e=>{0===e?2==o.value.salesSort?o.value.salesSort=0:o.value.salesSort++:1===e?2==o.value.moneySort?(o.value.moneySort=0,a.value.orderSort="",a.value.orderKey=""):(o.value.moneySort++,1==o.value.moneySort?a.value.orderSort="desc":a.value.orderSort="asc",a.value.orderKey="productPrice"):2===e&&(2==o.value.startSort?(o.value.startSort=0,a.value.orderSort="",a.value.orderKey=""):(o.value.startSort++,1==o.value.startSort?a.value.orderSort="desc":a.value.orderSort="asc",a.value.orderKey="ratio")),0!==e&&(o.value.salesSort=0),1!==e&&(o.value.moneySort=0),2!==e&&(o.value.startSort=0)},b=async()=>{try{const{data:e}=await Z({fCatId:"",level:1,pageIndex:1,pageSize:200});l.value=e.grid}catch(e){}},I=()=>{a.value.productId="",a.value.catId="",a.value.catLevel="",a.value.minPrice="",a.value.maxPrice="",a.value.minRatio="",a.value.maxRatio="",a.value.orderKey="",a.value.orderSort="",o.value.salesSort=0,o.value.moneySort=0,o.value.startSort=0},w=()=>{i.value.getGoodsGridList()};return(e,s)=>{const b=r("Breadcrumb"),z=J,C=x,j=_,V=S,P=k,U=B,R=r("icon-caret-up"),T=r("icon-caret-down"),q=O;return d(),n("div",Ve,[c(b,{items:["选品库","商品列表"]}),m("div",Pe,[c(q,{model:a.value,"auto-label-width":"","label-align":"left"},{default:v((()=>[c(V,{gutter:24},{default:v((()=>[c(C,{span:10,class:"mg-b-20"},{default:v((()=>[c(z,{modelValue:a.value.productId,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value.productId=e),placeholder:"请输入商品名称或商品链接","allow-clear":""},null,8,["modelValue"])])),_:1}),c(C,{span:4,class:"mg-b-20"},{default:v((()=>[c(j,{type:"primary",onClick:w},{default:v((()=>[p("搜索")])),_:1})])),_:1})])),_:1}),c(V,{gutter:24,class:"mg-b-20"},{default:v((()=>[c(C,{span:1.8},{default:v((()=>[Ue])),_:1}),c(C,{span:22},{default:v((()=>[m("div",Re,[m("div",{class:F(["list",t.value?"":"on"])},[c(P,{class:"li",color:a.value.catId?"gray":"arcoblue",onClick:s[1]||(s[1]=e=>g("",""))},{default:v((()=>[p(" 全部 ")])),_:1},8,["color"]),(d(!0),n(L,null,A(l.value,((e,l)=>(d(),N(P,{color:a.value.catId==e.catId?"arcoblue":"gray",class:"li",onClick:a=>g(e.catId,e.level)},{default:v((()=>[p(f(e.name),1)])),_:2},1032,["color","onClick"])))),256))],2),c(j,{class:"mg-t-10",type:"primary",onClick:s[2]||(s[2]=e=>t.value=!t.value)},{default:v((()=>[p(f(t.value?"展开":"收起"),1)])),_:1})])])),_:1})])),_:1}),c(V,{gutter:24,class:"mg-b-20"},{default:v((()=>[c(C,{span:1.8},{default:v((()=>[Te])),_:1}),c(C,{span:1.5},{default:v((()=>[p("价格: ")])),_:1}),c(C,{span:4},{default:v((()=>[c(U,{modelValue:a.value.minPrice,"onUpdate:modelValue":s[3]||(s[3]=e=>a.value.minPrice=e),min:"0",class:"input-r-text",placeholder:"起始价格",onChange:s[4]||(s[4]=e=>u(0,e))},null,8,["modelValue"]),Le])),_:1}),c(C,{span:1},{default:v((()=>[Ae])),_:1}),c(C,{span:4},{default:v((()=>[c(U,{modelValue:a.value.maxPrice,"onUpdate:modelValue":s[5]||(s[5]=e=>a.value.maxPrice=e),min:a.value.minPrice,class:"input-r-text",onChange:s[6]||(s[6]=e=>u(1,e)),"allow-clear":"",placeholder:"截止价格"},null,8,["modelValue","min"]),Ne])),_:1}),c(C,{span:1.7},{default:v((()=>[p("佣金比例: ")])),_:1}),c(C,{span:4},{default:v((()=>[c(U,{modelValue:a.value.minRatio,"onUpdate:modelValue":s[7]||(s[7]=e=>a.value.minRatio=e),min:"0",class:"input-r-text","allow-clear":"",onChange:s[8]||(s[8]=e=>u(2,e)),placeholder:"起始佣金"},null,8,["modelValue"]),qe])),_:1}),c(C,{span:1},{default:v((()=>[Me])),_:1}),c(C,{span:4},{default:v((()=>[c(U,{modelValue:a.value.maxRatio,"onUpdate:modelValue":s[9]||(s[9]=e=>a.value.maxRatio=e),min:a.value.minRatio,class:"input-r-text",onChange:s[10]||(s[10]=e=>u(3,e)),"allow-clear":"",placeholder:"截止佣金"},null,8,["modelValue","min"]),Ke])),_:1})])),_:1}),c(V,{gutter:24},{default:v((()=>[c(C,{span:1.8},{default:v((()=>[Ye])),_:1}),c(C,{span:2.5},{default:v((()=>[c(j,{type:0==o.value.moneySort?"outline":"primary",onClick:s[11]||(s[11]=e=>h(1))},{default:v((()=>[p(" 价格 "),m("span",Be,[2!=o.value.moneySort&&o.value.moneySort?y("",!0):(d(),N(R,{key:0,class:F(o.value.moneySort?"":"mg")},null,8,["class"])),1!=o.value.moneySort&&o.value.moneySort?y("",!0):(d(),N(T,{key:1}))])])),_:1},8,["type"])])),_:1}),c(C,{span:2.5},{default:v((()=>[c(j,{type:0==o.value.startSort?"outline":"primary",onClick:s[12]||(s[12]=e=>h(2))},{default:v((()=>[p(" 佣金比例 "),m("span",He,[2!=o.value.startSort&&o.value.startSort?y("",!0):(d(),N(R,{key:0,class:F(o.value.startSort?"":"mg")},null,8,["class"])),1!=o.value.startSort&&o.value.startSort?y("",!0):(d(),N(T,{key:1}))])])),_:1},8,["type"])])),_:1})])),_:1}),c(V,{justify:"end"},{default:v((()=>[c(C,{span:2.5},{default:v((()=>[c(j,{type:"primary",onClick:I},{default:v((()=>[p("重置筛选条件")])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])]),c(Ce,{ref_key:"goodsListRef",ref:i,"form-model":a.value},null,8,["form-model"])])}}}),[["__scopeId","data-v-980b0011"]]);export{Oe as default};
