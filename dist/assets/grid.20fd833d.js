import{_ as e}from"./index.a302575e.js";/* empty css              *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css              *//* empty css               */import{d as a,f as l,r as t,aH as s,D as d,E as n,H as u,aK as i,aJ as o,aO as r,u as p,aP as f,aM as c,aL as m,b_ as v,bk as g,bu as y,bv as _,c2 as b,bl as x,by as V,bG as T,bq as h,c3 as j,bz as w,c8 as z,c4 as C,c6 as k,c7 as I,c9 as S,be as U,b9 as q,ba as D,aF as Y,cd as M}from"./arco.0e1801a1.js";import{u as B}from"./loading.4d3258a0.js";import{s as N,a as P,b as A}from"./rule.9a62b1db.js";import{r as E,c as G,e as H}from"./enum.5f967a9b.js";import{f as L}from"./vue.6618b53d.js";import"./chart.b4fe0742.js";const O=e=>(q("data-v-047ad2c9"),e=e(),D(),e),F={class:"container"},J={class:"upai_content"},K=O((()=>u("div",{class:"pageTitle"}," 自动关停策略 ",-1))),R=O((()=>u("div",{class:"labelText"},"名称搜索：",-1))),Q={class:"pagination"},W={class:"nowrap"},X={class:"nowrap"},Z=O((()=>u("br",null,null,-1))),$=O((()=>u("br",null,null,-1))),ee=e(a({__name:"grid",setup(e,{expose:a}){const{loading:q,setLoading:D}=B(!0),O=l(!1),ee=l("新建计划包"),ae=l(["","元","元","元","小时","","","小时"]),le=l({name:null,type:1,firstType:1,firstVal:0,secondType:1,secondVal:0,flagType:1}),te=l(),se={current:1,pageIndex:1,pageSize:10},de=t({...se}),ne=()=>({startDate:v().add(-1,"month").format("YYYY-MM-DD").toString(),endDate:v().format("YYYY-MM-DD").toString(),name:"",pageIndex:1,pageSize:10}),ue=l(ne()),ie=l([]),oe=async e=>{D(!0);try{const{data:a}=await N(e);ie.value=a.grid,de.current=e.pageIndex,de.pageIndex=e.pageIndex,de.total=a.total}catch(a){}finally{D(!1)}},re=e=>{se.pageIndex=e,se.current=e,de.pageIndex=e,de.current=e,oe({...ue.value,...se})},pe=e=>{se.pageSize=e,de.pageSize=e,oe({...ue.value,...se})},fe=()=>{re(1)},ce=async e=>{var a;await(null==(a=te.value)?void 0:a.validate())?e(!1):(1===le.value.type?(await P({...le.value}),g.success({content:"添加关停策略成功",duration:5e3}),await fe()):(await A({...le.value}),g.success({content:"修改关停策略成功",duration:5e3}),await fe()),le.value.name=null,window.setTimeout((()=>{e()}),300))};L();const me=()=>{le.value.name=E[le.value.firstType]+le.value.firstVal+G[le.value.flagType]+E[le.value.secondType]+le.value.secondVal},ve=async(e,a)=>{2===e?(ee.value="修改关停策略",le.value.srId=a.srId,le.value.name=a.srName,le.value.firstType=a.firstType,le.value.firstVal=a.firstVal,le.value.flagType=a.flagType,le.value.secondType=a.secondType,le.value.secondVal=a.secondVal):(ee.value="新增关停策略",le.value={name:null,type:1,firstType:1,firstVal:0,secondType:1,secondVal:0,flagType:1},le.value.name=null,me()),le.value.type=e,O.value=!0};return oe({...ue.value}),a({fetchData:oe}),(e,a)=>{const l=s("Breadcrumb"),t=y,v=_,g=b,D=x,B=V,N=T,P=h,A=j,L=w,se=z,oe=s("icon-plus"),ge=C,ye=k,_e=I,be=M,xe=S,Ve=U;return d(),n("div",F,[u("div",J,[i(l,{items:["投流管理","自动关停策略"]}),K,i(A,null,{default:o((()=>[i(se,{class:"general-card-upai",style:{width:"100%"}},{default:o((()=>[i(A,null,{default:o((()=>[i(g,{flex:1},{default:o((()=>[i(L,{model:ue.value,"auto-label-width":"","label-align":"left"},{default:o((()=>[i(A,{gutter:16},{default:o((()=>[i(g,{span:8},{default:o((()=>[i(v,{field:"sphName"},{label:o((()=>[R])),default:o((()=>[i(t,{modelValue:ue.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>ue.value.name=e),placeholder:"请输入关停策略名称","allow-clear":"",onPressEnter:fe},null,8,["modelValue"])])),_:1})])),_:1}),i(g,{span:8},{default:o((()=>[i(v,{field:"number","hide-label":!0},{default:o((()=>[i(P,{size:18},{default:o((()=>[i(D,{type:"primary",class:"searchBtn",onClick:fe},{default:o((()=>[r(" 筛选 ")])),_:1}),i(D,{type:"outline",class:"refreshBtn",onClick:a[1]||(a[1]=e=>fe())},{default:o((()=>[r(" 刷新 ")])),_:1}),i(N,{type:"primary"},{default:o((()=>[i(B,{href:"javascript:void(0)",onClick:a[2]||(a[2]=e=>{ue.value=ne()})},{default:o((()=>[r("重置筛选条件")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})])),_:1})])),_:1}),i(se,{class:"general-card-upai",style:{width:"100%","padding-bottom":"28px"}},{default:o((()=>[i(A,{style:{"margin-bottom":"16px"}},{default:o((()=>[i(g,{span:16},{default:o((()=>[i(P,null,{default:o((()=>[i(D,{type:"primary",onClick:a[3]||(a[3]=e=>ve(1,null))},{icon:o((()=>[i(oe)])),default:o((()=>[r(" 创建关停策略 ")])),_:1})])),_:1})])),_:1})])),_:1}),i(A,null,{default:o((()=>[i(g,{flex:"1"},{default:o((()=>[i(ye,{"row-key":"id",pagination:!1,hoverable:!0,loading:p(q),stripe:!1,data:ie.value,bordered:!1},{columns:o((()=>[i(ge,{title:"关停策略名称","data-index":"srName",align:"center"}),i(ge,{title:"关停策略","data-index":"",align:"center"},{cell:o((({record:e})=>[r(f(p(E)[e.firstType]+e.firstVal+p(G)[e.flagType]+p(E)[e.secondType]+e.secondVal),1)])),_:1}),i(ge,{title:"更新时间","data-index":"updatedAt",align:"center"}),i(ge,{title:"创建时间","data-index":"createdAt",align:"center"}),i(ge,{align:"center",fixed:"right",title:"操作","data-index":"operations"},{cell:o((({record:e})=>[i(D,{type:"text",size:"small",onClick:a=>ve(2,e)},{default:o((()=>[r(" 修改 ")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["loading","data"]),u("div",Q,[u("div",null,[i(_e,{current:de.pageIndex,"onUpdate:current":a[4]||(a[4]=e=>de.pageIndex=e),"page-size":de.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>de.pageSize=e),total:de.total,"show-total":!0,"show-page-size":!0,"page-size-options":[10,20,50,100,200],onChange:re,onPageSizeChange:pe},null,8,["current","page-size","total"])])])])),_:1})])),_:1})])),_:1})]),i(Ve,{visible:O.value,"onUpdate:visible":a[12]||(a[12]=e=>O.value=e),title:ee.value,width:"950px",onCancel:a[13]||(a[13]=e=>O.value=!1),onBeforeOk:ce},{default:o((()=>[i(L,{ref_key:"formGpRef",ref:te,model:le.value,"auto-label-width":!0},{default:o((()=>[i(v,{field:"name",label:"关停策略名称",rules:[{required:!0,message:"请填写关停策略名称"}]},{default:o((()=>[i(t,{modelValue:le.value.name,"onUpdate:modelValue":a[6]||(a[6]=e=>le.value.name=e)},null,8,["modelValue"])])),_:1}),i(v,{field:"name",label:"自动关停条件",rules:[{required:!0,message:"请填写关停策略名称"}]},{default:o((()=>[i(A,{gutter:8,style:{width:"100%"}},{default:o((()=>[i(g,{span:6},{default:o((()=>[i(v,{field:"firstType","validate-trigger":"input",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:o((()=>[i(xe,{modelValue:le.value.firstType,"onUpdate:modelValue":a[7]||(a[7]=e=>le.value.firstType=e),onChange:me},{default:o((()=>[(d(!0),n(c,null,m(p(H)(p(E)),((e,a)=>(d(),Y(be,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(g,{span:4},{default:o((()=>[i(v,{field:"firstVal",rules:[{required:!0,message:"填写对应值"}],"no-style":""},{default:o((()=>[i(P,null,{default:o((()=>[i(t,{modelValue:le.value.firstVal,"onUpdate:modelValue":a[8]||(a[8]=e=>le.value.firstVal=e),onChange:me},null,8,["modelValue"]),u("span",W,f(ae.value[le.value.firstType])+",",1)])),_:1})])),_:1})])),_:1}),i(g,{span:4},{default:o((()=>[i(v,{field:"flagType",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:o((()=>[i(xe,{modelValue:le.value.flagType,"onUpdate:modelValue":a[9]||(a[9]=e=>le.value.flagType=e),onChange:me},{default:o((()=>[(d(!0),n(c,null,m(p(H)(p(G)),((e,a)=>(d(),Y(be,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(g,{span:6},{default:o((()=>[i(v,{field:"secondType","validate-trigger":"input",rules:[{required:!0,message:"请选择类型"}],"no-style":""},{default:o((()=>[i(xe,{modelValue:le.value.secondType,"onUpdate:modelValue":a[10]||(a[10]=e=>le.value.secondType=e),onChange:me},{default:o((()=>[(d(!0),n(c,null,m(p(H)(p(E)),((e,a)=>(d(),Y(be,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(g,{span:4},{default:o((()=>[i(v,{field:"secondVal",rules:[{required:!0,message:"填写对应值"}],"no-style":""},{default:o((()=>[i(P,null,{default:o((()=>[i(t,{modelValue:le.value.secondVal,"onUpdate:modelValue":a[11]||(a[11]=e=>le.value.secondVal=e),onChange:me},null,8,["modelValue"]),u("span",X,f(ae.value[le.value.secondType]),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),i(v,null,{default:o((()=>[i(N,{type:"secondary"},{default:o((()=>[r(" 提示："),Z,r(" “并且” 代表两个条件同时满足才触发自动关停 "),$,r(" “或者” 代表两个条件只需满足其中一个就会触发自动 ")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])])}}}),[["__scopeId","data-v-047ad2c9"]]);export{ee as default};
