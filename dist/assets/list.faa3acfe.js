import{v as e,_ as a}from"./index.a302575e.js";/* empty css              *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css                *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css               */import{d as l,f as t,r as d,c as r,w as n,aH as s,c6 as i,c8 as m,bu as u,bz as o,D as p,E as c,aK as v,aJ as f,bk as g,c3 as b,be as y,F as _,aG as k,aO as x,u as N,aP as h,c2 as j,bl as I,bq as R,c4 as D,bv as w}from"./arco.0e1801a1.js";import{u as C}from"./loading.4d3258a0.js";import{g as V,c as P,e as T,f as z}from"./settings.c4a72107.js";import{g as S}from"./event.471a062e.js";import"./chart.b4fe0742.js";import"./vue.6618b53d.js";const U={class:"container"},q={key:0,src:"https://img.adyinqing.com/upai_shop/x3pg1vne1690430298724",alt:"",class:"icon"},B={key:1,class:"tipsText"},O=a(l({name:"SearchTable",setup(a){const l=t([]);t([]),t([]);t();const{loading:O,setLoading:E}=C(!0);e.exports.useI18n();const F=t(!1),G=t([]),H=t({ruleName:"",ruleStatus:""}),J=t(!1),K=t(!1),L={pageIndex:1,pageSize:20};d({...L});const A=async e=>{E(!0);try{const{data:a}=await V(e);G.value=W(a.grid)}catch(a){}finally{E(!1),K.value=!0,setTimeout((()=>{J.value=!0}),320)}},M=t([]),Q=async e=>{E(!0);try{const{data:a}=await P(e);if(a.grid){const e=W(a.grid);M.value=e.map((e=>({menuName:e.menuName,menuId:e.menuId,children:e.children||[],icon:e.menuIcon||""})))}}catch(a){}finally{E(!1)}};Q({...L});const W=(e,a="children")=>{for(let l=0;l<e.length;l++){const t=e[l];t&&t[a]&&(0===t[a].length?delete t[a]:W(t[a],a))}return e},X=e=>{L.pageIndex=e,L.current=e,A({...L,...H.value})},Y=()=>{X(1),Q({...L})},Z=r((()=>l.value)),$=t(!1);n(Z,((e,a)=>{const l=S(M.value);e.length===l.length?F.value=!0:e.length<l.length&&e.length>0?$.value=!0:(F.value=!1,$.value=!1)})),A({...L,...H.value});const ee=t(!1),ae=t("新增部门"),le=t({deptName:"",depRemark:"",deptParent:0,type:1}),te=t({deptName:"",depRemark:"",deptParent:0,type:1}),de=(e,a)=>{2===e?(ae.value="编辑部门信息",te.value.deptName=a.memberDepName,te.value.depRemark=a.memberDepRemark,te.value.deptId=a.memberDepId,le.value.deptName=a.memberDepName,le.value.depRemark=a.memberDepRemark,le.value.leaderName=a.leaderName,le.value.deptId=a.memberDepId,l.value=[],te.value.type=2,le.value.type=2):(ae.value="新增部门",0!==a.memberDepId&&(ae.value="新增子部门"),le.value={deptName:"",depRemark:"",deptParent:0,type:1},le.value.deptParent=a.memberDepId,l.value=[],le.value.type=1),ee.value=!0},re=t(),ne=async e=>{var a;if(await(null==(a=re.value)?void 0:a.validate()))e(!1);else{if(1===le.value.type)T(le.value).then((({data:e,code:a})=>{200===a&&(g.success({content:"添加成功",duration:5e3}),Y())}));else{const e={deptId:le.value.deptId,deptName:le.value.deptName,depRemark:le.value.depRemark,leaderName:le.value.leaderName};await z(e),g.success({content:"修改成功",duration:5e3}),Y()}window.setTimeout((()=>{e()}),300)}},se=()=>{ee.value=!1};return(e,a)=>{const l=s("Breadcrumb"),t=j,d=b,r=s("icon-plus"),n=I,g=R,C=s("icon-refresh"),V=D,P=i,T=m,z=u,S=w,E=o,F=y;return p(),c("div",U,[v(l,{items:["系统管理","部门管理"]}),v(d,{align:"center"},{default:f((()=>[v(t,null,{default:f((()=>[K.value?(p(),c("div",{key:0,class:_(["topTipsBar",K.value?"tipsShow":""])},[J.value?(p(),c("img",q)):k("",!0),J.value?(p(),c("div",B,"全新团队管理上线。修改子账号的权限现调整为通过角色进行管理，请及时创建角色进行调整。（原子账号权限不受影响）")):k("",!0)],2)):k("",!0)])),_:1})])),_:1}),v(T,{class:"general-card",title:"部门管理"},{default:f((()=>[v(d,{style:{"margin-bottom":"16px"}},{default:f((()=>[v(t,{span:16},{default:f((()=>[v(g,null,{default:f((()=>[v(n,{type:"primary",onClick:a[0]||(a[0]=e=>de(1,{memberDepId:0}))},{icon:f((()=>[v(r)])),default:f((()=>[x(" 新建部门 ")])),_:1})])),_:1})])),_:1}),v(t,{span:8,style:{"text-align":"right"}},{default:f((()=>[v(n,{type:"primary",onClick:a[1]||(a[1]=e=>Y())},{icon:f((()=>[v(C)])),default:f((()=>[x(" 刷新 ")])),_:1})])),_:1})])),_:1}),v(P,{"row-key":"memberDepId",loading:N(O),pagination:!1,data:G.value,bordered:!1,onPageChange:X},{columns:f((()=>[v(V,{title:"部门名称"},{cell:f((({record:e})=>[x(h(e.memberDepName||"-"),1)])),_:1}),v(V,{title:"部门负责人",align:"center"},{cell:f((({record:e})=>[x(h(e.leaderName||"-"),1)])),_:1}),v(V,{title:"部门人数",align:"center"},{cell:f((({record:e})=>[x(h(e.memberCount||"-"),1)])),_:1}),v(V,{title:"部门备注",align:"center"},{cell:f((({record:e})=>[x(h(e.memberDepRemark||"-"),1)])),_:1}),v(V,{title:"操作","data-index":"operations",align:"center"},{cell:f((({record:e})=>[v(g,null,{default:f((()=>[v(n,{type:"text",size:"small",onClick:a=>de(2,e)},{default:f((()=>[x(" 编辑 ")])),_:2},1032,["onClick"]),v(n,{type:"text",size:"small",onClick:a=>de(1,e)},{default:f((()=>[x(" 新增子部门 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["loading","data"])])),_:1}),v(F,{visible:ee.value,"onUpdate:visible":a[5]||(a[5]=e=>ee.value=e),title:ae.value,width:1===le.value.type?"40%":"70%",onCancel:se,onBeforeOk:ne},{default:f((()=>[v(E,{ref_key:"formRef",ref:re,model:le.value,"label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:f((()=>[v(S,{field:"deptName",label:"部门名称",rules:[{required:!0,message:"请填写部门名称"}]},{default:f((()=>[v(z,{modelValue:le.value.deptName,"onUpdate:modelValue":a[2]||(a[2]=e=>le.value.deptName=e)},null,8,["modelValue"])])),_:1}),v(S,{field:"leaderName",label:"部门负责人"},{default:f((()=>[v(z,{modelValue:le.value.leaderName,"onUpdate:modelValue":a[3]||(a[3]=e=>le.value.leaderName=e)},null,8,["modelValue"])])),_:1}),v(S,{field:"depRemark",label:"备注（非必填）"},{default:f((()=>[v(z,{modelValue:le.value.depRemark,"onUpdate:modelValue":a[4]||(a[4]=e=>le.value.depRemark=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","width"])])}}}),[["__scopeId","data-v-37b3e42f"]]);export{O as default};
