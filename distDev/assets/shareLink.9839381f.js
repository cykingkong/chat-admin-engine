import{d as xe,g as ke,r as o,al as Ee,f as Se,v as De,i as Z,$ as we,j as s,o as y,a as ee,n as a,e as g,m as n,q as l,t as i,u as m,l as A,s as ae,a8 as ze,F as Me,k as Ae,M as L,am as te,an as Le,p as Pe,b as Ue,_ as Ve}from"./index.f3be9d6e.js";import{u as $e}from"./loading.b87f2d78.js";import{g as Te,a as qe}from"./sph.64c0f6af.js";import{m as ne,b as ue}from"./enum.5f967a9b.js";import{c as Re}from"./copy.b765ae4e.js";const P=C=>(Pe("data-v-810e58cd"),C=C(),Ue(),C),Ne={class:"container"},Oe={class:"bgWBox",style:{width:"100%"}},Qe=P(()=>g("h1",{style:{"font-size":"18px","margin-bottom":"10px","margin-top":"0",color:"#000"}}," \u9080\u8BF7\u8BB0\u5F55 ",-1)),je={class:"pagination"},Ke=P(()=>g("div",null,null,-1)),Ge={class:"pagination"},We=P(()=>g("div",null,null,-1)),He=xe({__name:"shareLink",setup(C){const U=ke(),oe=o(""),I=o("");Ee().then(t=>{console.log(t),I.value=t.data.shareLink,oe.value=t.data.authKey});const le=()=>({}),se=()=>{Re(`\u3010\u9B54\u529B\u667A\u6295\u3011
  \u89C6\u9891\u53F7\u5FAE\u4FE1\u8C46\u3001\u667A\u80FD\u6295\u653E\u5DE5\u5177\uFF0C\u8BA9\u4F60\u8F7B\u677E\u7A81\u7834ROI\u74F6\u9888~

  ${I.value}
  -------
  \u70B9\u51FB\u7ACB\u5373\u9886\u53D67\u5929\u514D\u8D39\u8BD5\u7528`),L.success("\u590D\u5236\u6210\u529F")};Se();const b=o(!1),h=o(!1),x=o([]),V=o(!1);o(!1),o([]),o("");const re=o(""),$=o(""),T=o(!1);o(),o(0),o(0);const q=o("\u4FEE\u6539\u4FE1\u606F"),_=o((()=>({id:void 0,sphType:0,sphRemark:"",type:1}))()),ie=o({remark:"\u5907\u6CE8"}),{loading:R,setLoading:N}=$e(!0);De.exports.useI18n();const O=o([]),k=o(le());o(!1),o("");const p={current:1,pageIndex:1,pageSize:10},d=Z({...p}),c=Z({...p}),E=async t=>{N(!0);try{const{data:u}=await te(t);O.value=u.grid,d.current=t.pageIndex,d.pageIndex=t.pageIndex,d.total=u.total}catch{}finally{N(!1)}},S=t=>{p.pageIndex=t,p.current=t,d.pageIndex=t,d.current=t,E({...k.value,...p})},ce=t=>{p.pageSize=t,d.pageSize=t,E({...k.value,...p})},Q=()=>{S(1)};E({...k.value,...p});const D=o(!1),v=o(null),j=async()=>{if(D.value)return;D.value=!0;const t=await qe({token:$.value});if(D.value=!1,t.data.status===5&&(T.value=!0),t.data.status===1){L.success({content:"\u767B\u5F55\u6210\u529F",duration:5*1e3}),V.value=!1,T.value=!1,Q(),clearInterval(v.value),v.value=null;return}v.value=setTimeout(j,1e3)},w=async t=>{console.log(t);const{data:u}=await te(t);u.grid?(x.value=u.grid,c.current=t.pageIndex,c.pageIndex=t.pageIndex,c.total=u.total):c.total=0},B=o(0),de=t=>{x.value=[],B.value=t.shareMemberId,w({shareLevel:2,shareMemberId:B.value,...p}),h.value=!0},pe=async(t,u)=>{if(t===2)q.value="\u4FEE\u6539\u5907\u6CE8",_.value.remark=u.remark,_.value.id=u.id,_.value.type=2,b.value=!0;else{b.value=!1;const{data:f}=await Te({});re.value=f.url,$.value=f.token,V.value=!0,v.value=setTimeout(j,1e3)}},me=t=>{c.pageIndex=t,c.current=t,w({shareLevel:2,shareMemberId:B.value,...c})},_e=t=>{c.pageSize=t,w({shareLevel:2,shareMemberId:B.value,...c})};we(()=>{clearInterval(v.value),v.value=null});const K=o(),ge=async t=>{var f;if(await((f=K.value)==null?void 0:f.validate())){t(!1);return}_.value.type===1||(await Le(_.value),L.success({content:"\u4FEE\u6539\u6210\u529F",duration:5*1e3}),Q()),window.setTimeout(()=>{t()},300)},fe=()=>{b.value=!1};return(t,u)=>{const f=s("Breadcrumb"),z=s("a-typography-text"),M=s("a-col"),ve=s("icon-link"),G=s("a-button"),W=s("a-row"),r=s("a-table-column"),H=s("a-tag"),be=s("icon-edit"),he=s("a-space"),J=s("a-table"),X=s("a-pagination"),Fe=s("a-card"),Y=s("a-modal"),ye=s("a-input"),Ce=s("a-form-item"),Be=s("a-form");return y(),ee("div",Ne,[a(f,{items:["\u9080\u8BF7\u94FE\u63A5"]}),g("div",Oe,[a(W,{gutter:16},{default:n(()=>[a(M,{flex:"80px"},{default:n(()=>[a(z,null,{default:n(()=>[l(" \u4E13\u5C5E\u94FE\u63A5 ")]),_:1})]),_:1}),a(M,{flex:"auto"},{default:n(()=>[a(z,{type:"primary",style:{cursor:"pointer"}},{default:n(()=>[l(i(I.value),1)]),_:1})]),_:1}),a(M,{flex:"80px"},{default:n(()=>[a(G,{type:"primary",onClick:u[0]||(u[0]=e=>se())},{icon:n(()=>[a(ve)]),default:n(()=>[l("\u590D\u5236\u94FE\u63A5 ")]),_:1})]),_:1})]),_:1})]),a(W),a(Fe,{class:"general-card-upai",style:{width:"100%","padding-bottom":"32px"}},{default:n(()=>[Qe,a(J,{"row-key":"id",pagination:!1,loading:m(R),data:O.value,hoverable:!0,stripe:!1,bordered:!1,onPageChange:S},{columns:n(()=>[a(r,{title:"\u6635\u79F0",align:"center"},{cell:n(({record:e})=>[l(i(e.shareMemberInfo?e.shareMemberInfo.memberPhone:"-"),1)]),_:1}),a(r,{title:"\u624B\u673A\u53F7\u7801",align:"center"},{cell:n(({record:e})=>[l(i(e.shareMemberInfo?e.shareMemberInfo.memberPhone:"-"),1)]),_:1}),a(r,{title:"\u5B9E\u4ED8\u91D1\u989D",align:"center"},{cell:n(({record:e})=>[l(i(e.payPrice?e.payPrice:"-"),1)]),_:1}),a(r,{title:"\u8D26\u53F7\u7C7B\u578B",align:"center"},{cell:n(({record:e})=>[a(H,{color:"arcoblue"},{default:n(()=>[l(i(e.shareMemberInfo?m(ne)[e.shareMemberInfo.memberLevel]:"-"),1)]),_:2},1024)]),_:1}),a(r,{title:"\u7ED1\u5B9A\u72B6\u6001",align:"center"},{cell:n(({record:e})=>[l(i(e.bindStatus?m(ue)[e.bindStatus]:"-"),1)]),_:1}),m(U).$state.memberChannel===2?(y(),A(r,{key:0,title:"\u4E8C\u7EA7\u9080\u8BF7",align:"center"},{cell:n(({record:e})=>[l(i(e.shareCount),1)]),_:1})):ae("",!0),a(r,{title:"\u521B\u5EFA\u65F6\u95F4",align:"center"},{cell:n(({record:e})=>[l(i(e.createdAt),1)]),_:1}),a(r,{title:"\u4F7F\u7528\u8FC7\u671F\u65F6\u95F4",align:"center"},{cell:n(({record:e})=>[l(i(e.shareMemberInfo?e.shareMemberInfo.memberExpiredAt:"-"),1)]),_:1}),a(r,{title:"\u5907\u6CE8",align:"center"},{cell:n(({record:e})=>[a(he,{size:8},{default:n(()=>[l(i(e.remark||"-")+" ",1),a(z,{type:"primary",style:{cursor:"pointer"},onClick:F=>pe(2,e)},{default:n(()=>[a(be)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1}),m(U).$state.memberChannel===2?(y(),A(r,{key:1,align:"center",title:"\u64CD\u4F5C","data-index":"operations",fixed:"right",width:250},{cell:n(({record:e})=>[a(G,{type:"text",size:"small",onClick:F=>de(e)},{default:n(()=>[l(" \u9080\u8BF7\u8BE6\u60C5 ")]),_:2},1032,["onClick"])]),_:1})):ae("",!0)]),_:1},8,["loading","data"]),g("div",je,[Ke,g("div",null,[a(X,{current:d.pageIndex,"onUpdate:current":u[1]||(u[1]=e=>d.pageIndex=e),"page-size":d.pageSize,"onUpdate:pageSize":u[2]||(u[2]=e=>d.pageSize=e),total:Number(d.total),"show-total":!0,"show-page-size":!0,"page-size-options":[10,20,50,100,200],onChange:S,onPageSizeChange:ce},null,8,["current","page-size","total"])])])]),_:1}),a(Y,{visible:h.value,"onUpdate:visible":u[5]||(u[5]=e=>h.value=e),title:"\u4E8C\u7EA7\u9080\u8BF7\u5217\u8868",width:"800px",onCancel:u[6]||(u[6]=e=>h.value=!1),onOk:u[7]||(u[7]=e=>h.value=!1)},{default:n(()=>[a(J,{"row-key":"id",pagination:!1,loading:m(R),data:x.value,hoverable:!0,stripe:!1,bordered:!1},{columns:n(()=>[a(r,{title:"\u6635\u79F0",align:"center"},{cell:n(({record:e})=>[l(i(e.shareMemberInfo.memberPhone),1)]),_:1}),a(r,{title:"\u8D26\u53F7\u7C7B\u578B",align:"center"},{cell:n(({record:e})=>[a(H,{color:"arcoblue"},{default:n(()=>[l(i(m(ne)[e.shareMemberInfo.memberLevel]),1)]),_:2},1024)]),_:1}),a(r,{title:"\u5B9E\u4ED8\u91D1\u989D",align:"center"},{cell:n(({record:e})=>[l(i(e.payPrice?e.payPrice:"-"),1)]),_:1}),a(r,{title:"\u7ED1\u5B9A\u72B6\u6001",align:"center"},{cell:n(({record:e})=>[l(i(e.bindStatus?m(ue)[e.bindStatus]:"-"),1)]),_:1}),a(r,{title:"\u4F7F\u7528\u72B6\u6001",align:"center"},{cell:n(({record:e})=>[l(i(Date.now()<m(ze)(e.shareMemberInfo.memberExpiredAt).valueOf()?"\u4F7F\u7528\u4E2D":"\u5DF2\u8FC7\u671F"),1)]),_:1})]),_:1},8,["loading","data"]),g("div",Ge,[We,g("div",null,[a(X,{current:c.pageIndex,"onUpdate:current":u[3]||(u[3]=e=>c.pageIndex=e),"page-size":c.pageSize,"onUpdate:pageSize":u[4]||(u[4]=e=>c.pageSize=e),total:Number(c.total),"show-total":!0,"show-page-size":!0,"page-size-options":[10,20,50,100,200],onChange:me,onPageSizeChange:_e},null,8,["current","page-size","total"])])])]),_:1},8,["visible"]),a(Y,{visible:b.value,"onUpdate:visible":u[8]||(u[8]=e=>b.value=e),title:q.value,onCancel:fe,onBeforeOk:ge},{default:n(()=>[a(Be,{ref_key:"formRef",ref:K,model:_.value,"label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:n(()=>[(y(!0),ee(Me,null,Ae(ie.value,(e,F)=>(y(),A(Ce,{key:e,field:F,label:e,rules:[{required:!0,message:"\u8BF7\u586B\u5199"+e}]},{default:n(()=>[a(ye,{modelValue:_.value[F],"onUpdate:modelValue":Ie=>_.value[F]=Ie},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["field","label","rules"]))),128))]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}});const ta=Ve(He,[["__scopeId","data-v-810e58cd"]]);export{ta as default};
