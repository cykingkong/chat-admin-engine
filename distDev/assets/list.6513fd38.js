import{d as ae,r as s,v as te,i as ue,c as le,w as ne,j as r,o as B,a as D,n as a,m as t,M as $,B as oe,s as V,q as c,u as se,t as b,_ as re}from"./index.f3be9d6e.js";import{u as de}from"./loading.b87f2d78.js";import{g as ce,c as me,e as ie,f as pe}from"./settings.12ac4961.js";import{g as _e}from"./event.471a062e.js";const fe={class:"container"},ve={key:0,src:"https://img.adyinqing.com/upai_shop/x3pg1vne1690430298724",alt:"",class:"icon"},ge={key:1,class:"tipsText"},Ee={name:"SearchTable"},Fe=ae({...Ee,setup(Be){const C=s([]);s([]),s([]);const K=()=>({ruleName:"",ruleStatus:""});s();const{loading:L,setLoading:_}=de(!0);te.exports.useI18n();const M=s(!1),T=s([]),w=s(K()),y=s(!1),k=s(!1),m={pageIndex:1,pageSize:20};ue({...m});const S=async l=>{_(!0);try{const{data:e}=await ce(l);T.value=h(e.grid)}catch(e){console.log(e)}finally{_(!1),k.value=!0,setTimeout(()=>{y.value=!0},320)}},f=s([]),j=async l=>{_(!0);try{const{data:e}=await me(l);if(e.grid){const d=h(e.grid);f.value=d.map(o=>({menuName:o.menuName,menuId:o.menuId,children:o.children||[],icon:o.menuIcon||""}))}console.log(f.value)}catch(e){console.log(e)}finally{_(!1)}};j({...m});const h=(l,e="children")=>{for(let d=0;d<l.length;d++){const o=l[d];o&&o[e]&&(o[e].length===0?delete o[e]:h(o[e],e))}return l},q=l=>{m.pageIndex=l,m.current=l,S({...m,...w.value})},N=()=>{q(1),j({...m})},O=le(()=>C.value),z=s(!1);ne(O,(l,e)=>{console.log(l.length,f.value.length);const d=_e(f.value);l.length===d.length?M.value=!0:l.length<d.length&&l.length>0?z.value=!0:(M.value=!1,z.value=!1)}),S({...m,...w.value});const v=s(!1),g=s("\u65B0\u589E\u90E8\u95E8"),I=()=>({deptName:"",depRemark:"",deptParent:0,type:1}),u=s(I()),E=s(I()),A=(l,e)=>{l===2?(g.value="\u7F16\u8F91\u90E8\u95E8\u4FE1\u606F",E.value.deptName=e.memberDepName,E.value.depRemark=e.memberDepRemark,E.value.deptId=e.memberDepId,u.value.deptName=e.memberDepName,u.value.depRemark=e.memberDepRemark,u.value.leaderName=e.leaderName,u.value.deptId=e.memberDepId,C.value=[],E.value.type=2,u.value.type=2):(g.value="\u65B0\u589E\u90E8\u95E8",e.memberDepId!==0&&(g.value="\u65B0\u589E\u5B50\u90E8\u95E8"),u.value=I(),u.value.deptParent=e.memberDepId,C.value=[],u.value.type=1),v.value=!0},P=s(),G=async l=>{var d;const e=await((d=P.value)==null?void 0:d.validate());if(console.log(e),e){l(!1);return}if(u.value.type===1)ie(u.value).then(({data:o,code:i})=>{i===200&&($.success({content:"\u6DFB\u52A0\u6210\u529F",duration:5*1e3}),N())});else{const o={deptId:u.value.deptId,deptName:u.value.deptName,depRemark:u.value.depRemark,leaderName:u.value.leaderName};await pe(o),$.success({content:"\u4FEE\u6539\u6210\u529F",duration:5*1e3}),N()}window.setTimeout(()=>{l()},300)},H=()=>{v.value=!1};return(l,e)=>{const d=r("Breadcrumb"),o=r("a-col"),i=r("a-row"),J=r("icon-plus"),F=r("a-button"),U=r("a-space"),Q=r("icon-refresh"),p=r("a-table-column"),W=r("a-table"),X=r("a-card"),x=r("a-input"),R=r("a-form-item"),Y=r("a-form"),Z=r("a-modal");return B(),D("div",fe,[a(d,{items:["\u7CFB\u7EDF\u7BA1\u7406","\u90E8\u95E8\u7BA1\u7406"]}),a(i,{align:"center"},{default:t(()=>[a(o,null,{default:t(()=>[k.value?(B(),D("div",{key:0,class:oe(["topTipsBar",k.value?"tipsShow":""])},[y.value?(B(),D("img",ve)):V("",!0),y.value?(B(),D("div",ge,"\u5168\u65B0\u56E2\u961F\u7BA1\u7406\u4E0A\u7EBF\u3002\u4FEE\u6539\u5B50\u8D26\u53F7\u7684\u6743\u9650\u73B0\u8C03\u6574\u4E3A\u901A\u8FC7\u89D2\u8272\u8FDB\u884C\u7BA1\u7406\uFF0C\u8BF7\u53CA\u65F6\u521B\u5EFA\u89D2\u8272\u8FDB\u884C\u8C03\u6574\u3002\uFF08\u539F\u5B50\u8D26\u53F7\u6743\u9650\u4E0D\u53D7\u5F71\u54CD\uFF09")):V("",!0)],2)):V("",!0)]),_:1})]),_:1}),a(X,{class:"general-card",title:"\u90E8\u95E8\u7BA1\u7406"},{default:t(()=>[a(i,{style:{"margin-bottom":"16px"}},{default:t(()=>[a(o,{span:16},{default:t(()=>[a(U,null,{default:t(()=>[a(F,{type:"primary",onClick:e[0]||(e[0]=n=>A(1,{memberDepId:0}))},{icon:t(()=>[a(J)]),default:t(()=>[c(" \u65B0\u5EFA\u90E8\u95E8 ")]),_:1})]),_:1})]),_:1}),a(o,{span:8,style:{"text-align":"right"}},{default:t(()=>[a(F,{type:"primary",onClick:e[1]||(e[1]=n=>N())},{icon:t(()=>[a(Q)]),default:t(()=>[c(" \u5237\u65B0 ")]),_:1})]),_:1})]),_:1}),a(W,{"row-key":"memberDepId",loading:se(L),pagination:!1,data:T.value,bordered:!1,onPageChange:q},{columns:t(()=>[a(p,{title:"\u90E8\u95E8\u540D\u79F0"},{cell:t(({record:n})=>[c(b(n.memberDepName||"-"),1)]),_:1}),a(p,{title:"\u90E8\u95E8\u8D1F\u8D23\u4EBA",align:"center"},{cell:t(({record:n})=>[c(b(n.leaderName||"-"),1)]),_:1}),a(p,{title:"\u90E8\u95E8\u4EBA\u6570",align:"center"},{cell:t(({record:n})=>[c(b(n.memberCount||"-"),1)]),_:1}),a(p,{title:"\u90E8\u95E8\u5907\u6CE8",align:"center"},{cell:t(({record:n})=>[c(b(n.memberDepRemark||"-"),1)]),_:1}),a(p,{title:"\u64CD\u4F5C","data-index":"operations",align:"center"},{cell:t(({record:n})=>[a(U,null,{default:t(()=>[a(F,{type:"text",size:"small",onClick:ee=>A(2,n)},{default:t(()=>[c(" \u7F16\u8F91 ")]),_:2},1032,["onClick"]),a(F,{type:"text",size:"small",onClick:ee=>A(1,n)},{default:t(()=>[c(" \u65B0\u589E\u5B50\u90E8\u95E8 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["loading","data"])]),_:1}),a(Z,{visible:v.value,"onUpdate:visible":e[5]||(e[5]=n=>v.value=n),title:g.value,width:u.value.type===1?"40%":"70%",onCancel:H,onBeforeOk:G},{default:t(()=>[a(Y,{ref_key:"formRef",ref:P,model:u.value,"label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:t(()=>[a(R,{field:"deptName",label:"\u90E8\u95E8\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u90E8\u95E8\u540D\u79F0"}]},{default:t(()=>[a(x,{modelValue:u.value.deptName,"onUpdate:modelValue":e[2]||(e[2]=n=>u.value.deptName=n)},null,8,["modelValue"])]),_:1}),a(R,{field:"leaderName",label:"\u90E8\u95E8\u8D1F\u8D23\u4EBA"},{default:t(()=>[a(x,{modelValue:u.value.leaderName,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value.leaderName=n)},null,8,["modelValue"])]),_:1}),a(R,{field:"depRemark",label:"\u5907\u6CE8\uFF08\u975E\u5FC5\u586B\uFF09"},{default:t(()=>[a(x,{modelValue:u.value.depRemark,"onUpdate:modelValue":e[4]||(e[4]=n=>u.value.depRemark=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","width"])])}}});const ke=re(Fe,[["__scopeId","data-v-37b3e42f"]]);export{ke as default};
