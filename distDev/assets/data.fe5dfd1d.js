import{d as Se,r,i as Ie,f as Me,a8 as s,j as n,o as z,a as J,e as h,n as t,m as a,F as Ke,k as Ve,u as A,q as d,t as O,M as P,p as ze,b as Oe,l as Pe,_ as Te}from"./index.f3be9d6e.js";import{u as Ge}from"./loading.b87f2d78.js";import{a as He,b as Ne,c as $e,d as Ue}from"./live.d4d5dd78.js";import{d as qe,e as je}from"./plant.f4170702.js";import{e as Le,h as W}from"./enum.5f967a9b.js";import{g as Re}from"./settings.12ac4961.js";import{c as Je}from"./event.471a062e.js";import{s as We}from"./sph.64c0f6af.js";import"./xlsx.7ccd4c4d.js";import{E as Qe}from"./export-list.7cee4e1c.js";const C=B=>(ze("data-v-4c63067c"),B=B(),Oe(),B),Xe={class:"container"},Ze={class:"upai_content"},et=C(()=>h("div",{class:"pageTitle"}," \u8BA1\u5212\u5305\u6570\u636E ",-1)),tt=C(()=>h("div",{class:"labelText"},"\u540D\u79F0\u641C\u7D22\uFF1A",-1)),at=C(()=>h("div",{class:"labelText"},"\u6240\u5C5E\u90E8\u95E8\uFF1A",-1)),ut=C(()=>h("div",{class:"labelText"},"\u52A0\u70ED\u72B6\u6001\uFF1A",-1)),ot=C(()=>h("div",{class:"labelText"},"\u521B\u5EFA\u65F6\u95F4\uFF1A",-1)),lt=Se({__name:"data",setup(B,{expose:Q}){const X=r(),Z=[{label:"\u5F53\u65E5",value:()=>[s().startOf("date").format("YYYY-MM-DD HH:mm:ss"),s().endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"\u6628\u65E5",value:()=>[s().add(-1,"day").startOf("date").format("YYYY-MM-DD HH:mm:ss"),s().add(-1,"day").endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"\u8FD1\u4E00\u5468",value:()=>[s().add(-1,"week").startOf("date").format("YYYY-MM-DD HH:mm:ss"),s().add(-1,"day").endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"\u8FD1\u4E00\u6708",value:()=>[s().add(-1,"month").startOf("date").format("YYYY-MM-DD HH:mm:ss"),s().add(-1,"day").endOf("date").format("YYYY-MM-DD HH:mm:ss")]},{label:"\u672C\u6708",value:()=>[s().startOf("month").startOf("date").format("YYYY-MM-DD HH:mm:ss"),s().endOf("date").format("YYYY-MM-DD HH:mm:ss")]}],ee=["","#7bc616","#ff5722"],{loading:te,setLoading:T}=Ge(!0),b=r(!1),Y=r("\u65B0\u5EFA\u8BA1\u5212\u5305"),c=r({name:null,type:1}),G=r(),D={current:1,pageIndex:1,pageSize:30,defaultPageSize:30,pageSizeOptions:[10,30,50,100],total:0,defaultCurrent:1,page:1},E=r(!1),H=r([]),k=r([]),g=Ie({...D}),S=r([{colKey:"packageName",title:"\u8BA1\u5212\u5305\u540D\u79F0",fixed:"left",align:"left",width:220},{colKey:"memberDepName",title:"\u6240\u5C5E\u90E8\u95E8",align:"center",width:120},{colKey:"estimatedWecoinAmount",title:"\u6295\u653E\u603B\u91D1\u989D",align:"center",width:150,sortType:"all",sorter:!0},{colKey:"plantCount",title:"\u603B\u8BA1\u5212\u6761\u6570",align:"center",width:150,sortType:"all",sorter:!0},{colKey:"plantHotCount",title:"\u52A0\u70ED\u8BA1\u5212\u6761\u6570",align:"center",width:150,sortType:"all",sorter:!0},{colKey:"hotStatus",title:"\u52A0\u70ED\u72B6\u6001",align:"center",width:100},{colKey:"process",title:"\u6D88\u8017\u6BD4\u4F8B",align:"center",width:170},{colKey:"cost",title:"\u6D88\u8017\u91D1\u989D",align:"center",width:120,sortType:"all",sorter:!0},{colKey:"productOrderCount",title:"\u8BA2\u5355\u6570",align:"center",width:100,sortType:"all",sorter:!0},{colKey:"productPlaceorderGmv",title:"\u8425\u4E1A\u989D",align:"center",width:100,sortType:"all",sorter:!0},{colKey:"roi",title:"ROI",align:"center",width:100},{colKey:"lr",title:"\u5229\u6DA6",align:"center",width:100},{colKey:"airCost",title:"\u7A7A\u8017\u503C",align:"center",width:120,sortType:"all",sorter:!0},{colKey:"qan_cost",title:"\u5343\u5C55\u6210\u672C",width:"100",align:"center"},{colKey:"click_rate",title:"\u70B9\u51FB\u7387",width:"100",align:"center"},{colKey:"click_cost",title:"\u70B9\u51FB\u6210\u672C",width:"100",align:"center"},{colKey:"zh_cost",title:"\u8F6C\u5316\u6210\u672C",width:"100",align:"center"},{colKey:"zh_rate",title:"\u8F6C\u5316\u7387",width:"100",align:"center"},{colKey:"productClickCountUv",title:"\u5546\u54C1\u70B9\u51FB",align:"center",width:120,sortType:"all",sorter:!0},{colKey:"exposureCount",title:"\u6D4F\u89C8",align:"center",width:100,sortType:"all",sorter:!0},{colKey:"likeCount",title:"\u70B9\u8D5E",align:"center",width:100,sortType:"all",sorter:!0},{colKey:"commentCount",title:"\u8BC4\u8BBA",align:"center",width:100,sortType:"all",sorter:!0},{colKey:"updatedAt",title:"\u66F4\u65B0\u65F6\u95F4",align:"center",width:120},{colKey:"op",title:"\u64CD\u4F5C",fixed:"right",align:"center",width:150}]);H.value=S.value.map(e=>e.colKey==="row-select"?console.log("45678"):e.colKey);const N=()=>({startDate:s().add(-1,"month").format("YYYY-MM-DD").toString(),endDate:s().format("YYYY-MM-DD").toString(),pageIndex:1,pageSize:30,hotStatus:-1,taskStatus:-1}),I=e=>isNaN(e)||Number(e)===0?0:Number(e).toFixed(2),_=e=>isNaN(e)||Number(e)===0||e===1/0?"-":Number(e).toFixed(2),i=r(N()),$=r([]);r(0);const ae=r([]),ue=r([]),oe=r([]);function U(e,u){for(let l=0;l<e.length;l++){const p=e[l];if(p.memberDepId===u)return p.memberDepName;if(p.children&&p.children.length>0){const f=U(p.children,u);if(f)return f}}return null}const le=async e=>{const{data:u}=await Re(e);return u.grid?k.value=Je(u.grid):k.value=[],new Promise(l=>{l(!0)})},ne=()=>{delete i.value.memberDepId},re=async()=>{const{data:e}=await We({pageIndex:1,pageSize:200,sphType:1});ae.value=e.grid},se=async()=>{const{data:e}=await qe({pageIndex:1,pageSize:200});ue.value=e.grid},ie=async()=>{const{data:e}=await je({pageIndex:1,pageSize:200});oe.value=e.grid},M=async e=>{T(!0);try{const{data:u}=await He(e);u.grid&&u.grid.forEach((l,p)=>{l.key=String(p+1),l.click_cost=_(l.cost/l.productClickCountPv),l.memberDepName=l.memberDepId?U(k.value,l.memberDepId):"-",l.click_rate=_(l.productClickCountPv/l.exposureCount*100)==="-"?"-":`${_(l.productClickCountPv/l.exposureCount*100)}%`,l.qan_cost=_(l.cost/l.exposureCount*1e3),l.zh_cost=_(l.cost/l.productOrderCount),l.zh_rate=_(l.productOrderCount/l.productClickCountPv*100)==="-"?"-":`${_(l.productOrderCount/l.productClickCountPv*100)}%`,l.shutdownSwitch=l.shutdownStatus!==0}),$.value=u.grid||[],g.current=e.pageIndex,g.pageIndex=e.pageIndex,g.total=u.total}catch{}finally{T(!1)}},q=e=>{D.pageIndex=e.current,D.current=e.current,D.pageSize=e.pageSize,g.pageIndex=e.current,g.current=e.current,g.pageSize=e.pageSize,M({...i.value,...D})},ce=e=>{e&&(i.value.startDate=e[0],i.value.endDate=e[1])},v=()=>{q({current:1,pageSize:g.pageSize})},de=async e=>{const{data:u}=await Ne({packageId:e.packageId});u&&(P.success({content:"\u5220\u9664\u8BA1\u5212\u5305\u6210\u529F",duration:5*1e3}),await v())},j=async(e,u)=>{e===2?(Y.value="\u4FEE\u6539\u8BA1\u5212\u5305",c.value.packageId=u.packageId,c.value.name=u.packageName):(Y.value="\u65B0\u589E\u8BA1\u5212\u5305",c.value.name=null),c.value.type=e,b.value=!0},pe=async e=>{var l;if(await((l=G.value)==null?void 0:l.validate())){e(!1);return}c.value.type===1?(await $e({name:c.value.name}),P.success({content:"\u6DFB\u52A0\u8BA1\u5212\u5305\u6210\u529F",duration:5*1e3}),await v()):(await Ue({packageId:c.value.packageId,name:c.value.name}),P.success({content:"\u4FEE\u6539\u8BA1\u5212\u5305\u6210\u529F",duration:5*1e3}),await v()),c.value.name=null,window.setTimeout(()=>{e()},300)},me=Me(),K=r([]);localStorage.getItem("package-disPlayColumns")?K.value=JSON.parse(localStorage.getItem("package-disPlayColumns")):S.value.forEach(e=>{K.value.push(e.colKey)});const fe=async e=>{localStorage.setItem("package-disPlayColumns",JSON.stringify(e))},ge=e=>{me.push({name:"plantliveData",query:{packageId:e.packageId,packageCreaedAt:s(e.createdAt).unix()}})},_e=async e=>{e?(i.value.orderKey=e.sortBy,i.value.orderSort=e.descending?"DESC":"ASC"):i.value.orderSort=null,v()},F=r([]);F.value=[s().add(-1,"month"),s()];const ve=()=>{i.value=N(),F.value=[s().add(-1,"month"),s()]};return(()=>{re(),se(),ie(),le({pageIndex:1,pageSize:150}).then(e=>{M({...i.value})})})(),Q({fetchData:M}),(e,u)=>{const l=n("Breadcrumb"),p=n("a-input"),f=n("a-form-item"),m=n("a-col"),ye=n("a-cascader"),he=n("a-option"),De=n("a-select"),Ce=n("a-range-picker"),y=n("a-button"),Be=n("a-link"),be=n("a-typography-text"),V=n("a-space"),w=n("a-row"),L=n("a-form"),R=n("a-card"),ke=n("icon-plus"),Fe=n("icon-settings"),we=n("a-progress"),xe=n("a-tag"),Ae=n("a-popconfirm"),Ye=n("t-table"),Ee=n("a-modal");return z(),J("div",Xe,[h("div",Ze,[t(l,{items:["\u6295\u6D41\u7BA1\u7406","\u8BA1\u5212\u5305"]}),et,t(w,null,{default:a(()=>[t(R,{class:"general-card-upai",style:{width:"100%"}},{default:a(()=>[t(w,null,{default:a(()=>[t(m,{flex:1},{default:a(()=>[t(L,{model:i.value,"auto-label-width":"","label-align":"left"},{default:a(()=>[t(w,{gutter:16},{default:a(()=>[t(m,{span:8},{default:a(()=>[t(f,{field:"name"},{label:a(()=>[tt]),default:a(()=>[t(p,{modelValue:i.value.name,"onUpdate:modelValue":u[0]||(u[0]=o=>i.value.name=o),placeholder:"\u8BF7\u8F93\u5165\u8BA1\u5212\u5305\u540D\u79F0","allow-clear":"",onPressEnter:v},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{span:8},{default:a(()=>[t(f,{field:"sphId"},{label:a(()=>[at]),default:a(()=>[t(ye,{modelValue:i.value.memberDepId,"onUpdate:modelValue":u[1]||(u[1]=o=>i.value.memberDepId=o),options:k.value,"check-strictly":"","allow-clear":"","field-names":{value:"memberDepId",label:"memberDepName"},placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u90E8\u95E8",onClear:ne},null,8,["modelValue","options"])]),_:1})]),_:1}),t(m,{span:8},{default:a(()=>[t(f,{field:"hotStatus"},{label:a(()=>[ut]),default:a(()=>[t(De,{modelValue:i.value.hotStatus,"onUpdate:modelValue":u[2]||(u[2]=o=>i.value.hotStatus=o),placeholder:"\u8BF7\u9009\u62E9\u52A0\u70ED\u72B6\u6001"},{default:a(()=>[(z(!0),J(Ke,null,Ve(A(Le)(A(W)),(o,x)=>(z(),Pe(he,{key:x,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(m,{span:10},{default:a(()=>[t(f,{field:"createdTime"},{label:a(()=>[ot]),default:a(()=>[t(Ce,{modelValue:F.value,"onUpdate:modelValue":u[3]||(u[3]=o=>F.value=o),"show-time":"","default-value":[],style:{width:"100%"},shortcuts:Z,"shortcuts-position":"left",onChange:ce},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{span:8}),t(m,{span:6}),t(m,{span:8},{default:a(()=>[t(f,{field:"number","hide-label":!0},{default:a(()=>[t(V,{size:18},{default:a(()=>[t(y,{type:"primary",class:"searchBtn",onClick:v},{default:a(()=>[d(" \u7B5B\u9009 ")]),_:1}),t(y,{type:"outline",class:"refreshBtn",onClick:u[4]||(u[4]=o=>v())},{default:a(()=>[d(" \u5237\u65B0 ")]),_:1}),t(be,{type:"primary"},{default:a(()=>[t(Be,{href:"javascript:void(0)",onClick:u[5]||(u[5]=o=>ve())},{default:a(()=>[d("\u91CD\u7F6E\u7B5B\u9009\u6761\u4EF6")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1}),t(R,{class:"general-card-upai",style:{width:"100%","padding-bottom":"28px"}},{default:a(()=>[t(w,{justify:"space-between"},{default:a(()=>[t(m,{flex:"250px"},{default:a(()=>[t(V,{size:18,style:{"margin-bottom":"10px"}},{default:a(()=>[t(y,{type:"primary",onClick:u[6]||(u[6]=o=>j(1))},{icon:a(()=>[t(ke)]),default:a(()=>[d(" \u521B\u5EFA\u8BA1\u5212\u5305 ")]),_:1})]),_:1})]),_:1}),t(m,{flex:"60px"},{default:a(()=>[t(V,{size:18,style:{"margin-bottom":"10px"}},{default:a(()=>[t(y,{type:"primary",onClick:u[7]||(u[7]=o=>E.value=!0)},{icon:a(()=>[t(Fe)]),default:a(()=>[d(" \u5217\u8868\u914D\u7F6E ")]),_:1})]),_:1})]),_:1})]),_:1}),t(Ye,{columnControllerVisible:E.value,"onUpdate:columnControllerVisible":u[8]||(u[8]=o=>E.value=o),"row-key":"plantId",data:$.value,columns:S.value,loading:A(te),"header-affixed-top":!0,"max-height":1e3,"column-controller":{placement:"top-right",fields:H.value,dialogProps:{preventScrollThrough:!0},hideTriggerButton:!0},pagination:g,bordered:!1,"table-layout":"fixed","default-display-columns":K.value,"on-display-columns-change":fe,onPageChange:q,onSortChange:_e},{process:a(({row:o})=>[t(we,{percent:Number(I(o.cost/o.estimatedWecoinAmount)),style:{width:"50%"}},null,8,["percent"])]),roi:a(({row:o})=>[d(O(I(o.productPlaceorderGmv/o.cost)),1)]),lr:a(({row:o})=>[d(O(I(o.productPlaceorderGmv-o.cost)),1)]),hotStatus:a(({row:o})=>[t(xe,{color:ee[o.hotStatus]},{default:a(()=>[d(O(A(W)[o.hotStatus]),1)]),_:2},1032,["color"])]),op:a(({row:o})=>[t(y,{type:"text",size:"small",onClick:x=>ge(o)},{default:a(()=>[d(" \u67E5\u770B\u8BA1\u5212 ")]),_:2},1032,["onClick"]),t(y,{type:"text",size:"small",onClick:x=>j(2,o)},{default:a(()=>[d(" \u4FEE\u6539 ")]),_:2},1032,["onClick"]),t(Ae,{content:"\u786E\u8BA4\u662F\u5426\u5220\u9664\u6B64\u8BA1\u5212","ok-text":"\u786E\u8BA4",onOk:x=>de(o)},{default:a(()=>[t(y,{type:"text",size:"small"},{default:a(()=>[d(" \u5220\u9664 ")]),_:1})]),_:2},1032,["onOk"])]),_:1},8,["columnControllerVisible","data","columns","loading","column-controller","pagination","default-display-columns"])]),_:1})]),t(Ee,{visible:b.value,"onUpdate:visible":u[10]||(u[10]=o=>b.value=o),title:Y.value,onCancel:u[11]||(u[11]=o=>b.value=!1),onBeforeOk:pe},{default:a(()=>[t(L,{ref_key:"formGpRef",ref:G,model:c.value,"label-col-props":{span:6},"wrapper-col-props":{span:18}},{default:a(()=>[t(f,{field:"name",label:"\u8BA1\u5212\u5305\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u8BA1\u5212\u5305\u540D\u79F0"}]},{default:a(()=>[t(p,{modelValue:c.value.name,"onUpdate:modelValue":u[9]||(u[9]=o=>c.value.name=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t(Qe,{ref_key:"exportList",ref:X},null,512)])}}});const vt=Te(lt,[["__scopeId","data-v-4c63067c"]]);export{vt as default};
